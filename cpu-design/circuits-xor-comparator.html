<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Circuits: XOR Comparator</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        // MANDATORY: Configure Tailwind to include the Typography plugin.
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                },
            },
            plugins: [
                require('@tailwindcss/typography'),
            ],
        }
    </script>
    <style>
        /* STRICT LIGHT THEME MANDATE: Overrides dark mode settings */
        html { 
            font-family: 'Inter', sans-serif; 
            background-color: #FDFBF8; 
            color: #1A1A1A; 
        }
        @media (prefers-color-scheme: dark) {
            html {
                background-color: #FDFBF8 !important; 
                color: #1A1A1A !important; 
            }
        }
        /* Custom class for Skip Link (visible on focus) */
        .skip-link {
            position: absolute;
            top: -40px;
            left: 0;
            background: #1A1A1A;
            color: white;
            padding: 8px;
            z-index: 100;
            transition: top 0.3s;
        }
        .skip-link:focus {
            top: 0;
        }
    </style>
</head>
<body class="bg-[#FDFBF8] text-[#1A1A1A]">
    <a id="skip-to-content" href="#main-content" class="skip-link" tabindex="0">Skip to Content</a>
    
    <header class="bg-white shadow-md p-4 sticky top-0 z-10">
        <div class="max-w-7xl mx-auto">
            <h1 class="text-2xl font-bold text-[#1A1A1A]">Circuits: XOR Comparator</h1>
        </div>
    </header>

    <main id="main-content" class="p-4 sm:p-6 lg:p-8 max-w-7xl mx-auto">
        
        <h1 class="text-4xl font-extrabold mb-8 text-blue-700">Circuits: XOR Comparator</h1>

        <section class="mb-8 p-6 bg-white rounded-xl shadow-lg">
            <div class="prose max-w-none">
                <h2 class="text-3xl font-bold mt-0 mb-4">XOR Comparator Functionality</h2>
                <p>For this function, we want to create a circuit that will do **three different things**:</p>
                <ol class="list-decimal list-inside space-y-2">
                    <li>Output the results from a bit-wise **Exclusive OR** for two 8-bit inputs. This will be an **8-bit output**.</li>
                    <li>Output if the two 8-bit inputs are **equal**. This will be a **1-bit output** of 1 if equal and 0 if not equal.</li>
                    <li>Output if input "**a**" is **larger** than input "**b**" - over all 8 bits. This will be a **1-bit output** of 1 if "a" is larger than "b" and 0 if equal or less than "b".</li>
                </ol>
                <p>We want to work our way up to an 8-bit version by progressing as follows:</p>
            </div>
        </section>

        <div class="mb-8">
            <nav class="flex overflow-x-auto whitespace-nowrap border-b border-gray-300" role="tablist" aria-label="XOR Comparator Steps">
                <button 
                    id="tab-comparing-2-bits-button" 
                    class="tab-button px-4 py-2 text-lg font-medium border-b-2 border-blue-700 text-blue-700 bg-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-700"
                    role="tab" 
                    aria-controls="tab-comparing-2-bits" 
                    aria-selected="true"
                    data-tab-content="tab-comparing-2-bits"
                >
                    Comparing 2 bits
                </button>
                
                <button 
                    id="tab-recognizing-higher-bits-button" 
                    class="tab-button px-4 py-2 text-lg font-medium border-b-2 border-transparent text-[#1A1A1A] hover:border-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-700"
                    role="tab" 
                    aria-controls="tab-recognizing-higher-bits" 
                    aria-selected="false"
                    data-tab-content="tab-recognizing-higher-bits"
                >
                    Recognizing Higher Bits
                </button>

                <button 
                    id="tab-chaining-for-8-bits-button" 
                    class="tab-button px-4 py-2 text-lg font-medium border-b-2 border-transparent text-[#1A1A1A] hover:border-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-700"
                    role="tab" 
                    aria-controls="tab-chaining-for-8-bits" 
                    aria-selected="false"
                    data-tab-content="tab-chaining-for-8-bits"
                >
                    Chaining for 8 bits
                </button>
            </nav>

            <div id="tab-comparing-2-bits" class="tab-content p-6 bg-white rounded-b-xl shadow-lg border border-t-0 border-gray-300" role="tabpanel" tabindex="0">
                <h2 class="text-2xl font-bold">Two-bit XOR Gate Properties</h2>
                <div class="prose max-w-none">
                    <p>The first thing we want to do is to look at the truth table for an **XOR Gate**, which gives us our primary XOR result:</p>
                    <div class="flex justify-center my-6">
                        <img src="images/xor-truth-table.jpg" alt="XOR Truth Table showing that output is 1 only when inputs are different" class="max-w-xs h-auto rounded-lg shadow-md border border-gray-300" />
                    </div>

                    <p>The truth table shows that when the two inputs are the same, the output is 0 and when they are different the output is 1. This is the definition of the exclusive OR. Now we want to consider if we can check if the 2 bits are equal or not and if they are equal, we want an output of 1. If they are not equal we want an output of 0. If we consider the truth table provided, we can see that the XOR gate produces the exact opposite of what we want to find out of the 2 inputs are equal. So to get an equals evaluation, we can branch off the output and add a NOT gate to this new circuit to get the equals bit.</p>
                    <div class="flex justify-center my-6">
                        <img src="images/xor-equals-1bit.jpg" alt="XNOR Truth Table showing that output is 1 only when inputs are the same" class="max-w-xs h-auto rounded-lg shadow-md border border-gray-300" />
                    </div>

                    <p>The third function that we want to perform is to output a 1 if a is larger than b and a 0 otherwise. We can do this by adding an AND gate that takes as inputs, a and the output from our XOR gate. When the XOR result is 0, the two values, a and b, are the same so "a" cannot be larger than b (so the "a larger" result will be 0). When the XOR gate result is 1, the two values of "a" and "b" are different, one is 1 and the other is 0. "a" is larger when it is 1 and "b" is 0. We can get this result by putting the value of "a" into the AND gate with the output from the XOR (If we wanted to check if "b" is larger, we would use "b" and the XOR result as the inputs to the AND gate). This is shown in the diagram below.

</p>
                    <div class="flex justify-center my-6">
                        <img src="images/xor-aLarger-1bit.jpg" alt="2-bit XOR Comparator Circuit Diagram showing NOT gate on XOR output to determine if inputs are equal" class="max-w-md h-auto rounded-lg shadow-md border border-gray-300" />
                    </div>

                    <p>You should create this circuit and test it to verify that for each of the 4 possible input combinations, you get the correct values for the output, equals and larger bits.</p>
                    
                </div>
            </div>

            <div id="tab-recognizing-higher-bits" class="tab-content hidden p-6 bg-white rounded-b-xl shadow-lg border border-t-0 border-gray-300" role="tabpanel" tabindex="0">
                <h2 class="text-2xl font-bold">Extending to Higher Order bits</h2>
                <div class="prose max-w-none">
                    <p>For each bit combination, we have the output from the XOR plus the "equals" bit and the "a larger" bit. In an 8-bit function, we need to account for the results from the other bits in our evaluation of equals and larger (The output is bit-by-bit result so the result for any one bit location set is not impacted by other results). In evaluating the larger and equals, it is easiest to work from the higher value bits to the lower ones. Doing the evaluation in this order simplifies the overall comparison process.</p>
                    
                    <p>To do this, we first should consider that we have 3 possible conditions from the higher to the next lower bit that are:</p>
                    <ul class="list-disc list-inside space-y-1">
                        <li>The higher order bit for "a" is larger so continued evaluation is not required (since higher bit for "a" is larger,  comparisions are done)</li>
                        <li>The higher order bit for "a" equals that for "b" - so "a" may be larger, equals or smaller than "b"</li>
                        <li>The higher order bit for "a" is less than for "b" - so "a" is not larger or equals and comparisons are done.</li>
                    </ul>

                    <h3 class="text-xl font-semibold mt-4 mb-2">Let's take the first case</h3>
                    <p> In each of the cases, you should test and verify that the results match what they should for all possible combinations of inputs.</p>
                    <p>We can take the result from the higher order bit for "a larger" and OR that with the "a larger" for the current bit so that if the higher order is larger, then the value this comparison will pass down is also "a larger" regardless of what the evaluation for the current set of bits is.
                    </p>
                    
                    <div class="flex justify-center my-6">
                        <img src="images/xor-aLarger-cascade.jpg" alt="Detailed logic circuit for the Is Larger (L) output using AND and OR gates to combine current bit comparison (a and not b) with the prior is equal (pe) and prior is larger (pl) inputs" class="max-w-xl h-auto rounded-lg shadow-md border border-gray-300" />
                    </div>

                    <h3 class="text-xl font-semibold mt-4 mb-2">Case 2</h3>
                    <p>In case 2, the higher order is not larger but it may be equal to. The first thing we want to do is to evaluate the "equals" portion of the circuit. To do that, we want to AND the "prior equals" being passed down with the current bit position evaluation of equals as shown below. This will return equals ONLY when the prior bit is equals and the current bit is equals. Whenever the prior bit is larger or small, then the prior equals will be 0 and the AND ensures that what will get passed down to the next bit location is not equals.</p>
                    <div class="flex justify-center my-6">
                        <img src="images/xor-aEquals-cascade.png" alt="Single-bit XOR Comparator with chaining inputs for prior larger (pl) and prior equal (pe)" class="max-w-xl h-auto rounded-lg shadow-md border border-gray-300" />
                    </div>
                    
                    <h3 class="text-xl font-semibold mt-4 mb-2">Case 3</h3>
                    <p>The complicating case is when the prior bit is equals, it means that the prior bit is not larger so we need to only check the current bit if the prior bit is equals. If we think about the 3 possible combinations, when the prior bit is equals, then the current bit comparison can determine that "a" is larger. To do this, we need to modify our original 2 input AND gate on the  "is Larger" leg of the circuit to a 3 input AND gate to include the "prior equals" result. When the prior equals is "1" or they are equal, the "is Larger" will be evaluated based upon the current bit position.</p>

</p>
                    <div class="flex justify-center my-6">
                        <img src="images/xor-aEquals-cascade-final.png" alt="Circuit appearance of the single-bit comparator component with inputs A, B, pl, pe and outputs O, l, e" class="max-w-xs h-auto rounded-lg shadow-md border border-gray-300" />
                    </div>
                    <p>Again, make sure to build each of these cases and test them in your project to understand and verify that the circuits work as intended. Make sure to modify the circuit appearance of your final version to make it easier to include in the 8-bit chained result you will need for the ALU.</p>
                </div>
            </div>

            <div id="tab-chaining-for-8-bits" class="tab-content hidden p-6 bg-white rounded-b-xl shadow-lg border border-t-0 border-gray-300" role="tabpanel" tabindex="0">
                <h2 class="text-2xl font-bold">The Complete 8-bit XOR Comparator</h2>
                <div class="prose max-w-none">
                    <p>To complete the 8-bit evaluation, we need to chain the "a-larger" and "equals" bits from the higher order bits into the next lower level (from 7 to 6 to 5 ... to 0). We also need to take the individual outputs from each bit and place them in the appropriate position for the 8-bit XOR result out. You will need to seed the beginning comparisons for "is larger" and "is even". Since we do these from bit-7 to bit-0, then the input for the 7th bit comparator needs to be 0 for "prior a larger" and 1 for "prior equals". You can test this in your XOR with LE for 1-bit by replacing these inputs with the appropriate constants as indicated in this image.</p>
                    
                    <div class="flex justify-center my-6">
                        <img src="images/xor-testing.png" alt="Detail diagram showing l and e outputs of one comparator feeding the pl and pe inputs of the next lower comparator" class="max-w-2xl h-auto rounded-lg shadow-md border border-gray-300" />
                    </div>
                    
                    <p>Because we need to pass values from the XOR comparison from one-bit placement to the next, how you make your 1-bit XOR comparator with "is larger" and "is even" evaluators, it is imperative that you think about where you have the prior inputs and the outputs for passing to the next bit. As you will see below, I choose to setup my 8-bit XOR comparator with bits 0 through 7 stacked from bottom-to-top. Since we evaluate "is larger" and "is even" from left-to-right in our 8-bit inputs (bits 7 to 0), I need to place my "prior" values at the top of my circuit appearance and the outputs at the bottom to pass as inputs to the XOR bit comparator just below it.</p>
                    <div class="flex justify-center my-6">
                        <img src="images/xor-1bit-appearance.png" alt="8-bit XOR comparator chained circuit with is larger and is equal evaluation" class="max-w-4xl h-auto rounded-lg shadow-md border border-gray-300" />
                    </div>

                    <p>I realize that this description might be confusing so the following image shows how my 8-bit "a XOR b with 'is larger' and 'is even' bits" is laid out in my solution. In this image, the single bit XOR evaluations between a and b are from the bottom to the top. The evaluations for "is larger" and "is even" are from the Top to the Bottom so the constants of 1 for "is even" and ground (0) for "is larger" are the inputs to the bit 7 comparison with the evaluation output from the bit 0 comparison.</p>
                    <div class="flex justify-center my-6">
                        <img src="images/xor-8bit-chaining-circuit.png" alt="8-bit XOR comparator chained circuit with is larger and is equal evaluation" class="max-w-4xl h-auto rounded-lg shadow-md border border-gray-300" />
                    </div>
                    
                    <h3 class="text-xl font-semibold mt-6 mb-2">Component Pin Definitions</h3>
                    <p>For the single-bit comparator circuit components shown above, the pins represent:</p>
                    <div class="p-4 bg-gray-50 border border-gray-200 rounded-lg">
                        <p style="padding-left: 40px;">a = 1-bit input<br />b = 1-bit input<br />pl = prior "is larger"<br />pe = prior "is equal"<br />l = "is larger" output<br />e = "is equal" output<br />o = XOR result</p>
                    </div>

                    <p class="mt-6">Make sure to create a new circuit appearance after chaining and verifying that it works, for integration into higher level assemblies. One possible representation is shown below:</p>
                    <div class="flex justify-center my-6">
                        <img src="images/xor-comparator-circuit-appearance.jpg" alt="Circuit appearance for the 8-bit XOR Comparator" class="max-w-xs h-auto rounded-lg shadow-md border border-gray-300" />
                    </div>
                </div>
            </div>
        </div>
        <footer class="mt-8 pt-4 border-t border-gray-300 text-center text-sm text-gray-500">
            <div class="prose max-w-none mx-auto">
                <p class="text-xs italic">Ref: This project adapted from "Design a CPU" by Ross McGowan (On Udemy)</p>
            </div>
        </footer>
    </main>
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const tabButtons = document.querySelectorAll('.tab-button');
            const tabContents = document.querySelectorAll('.tab-content');

            const activateTab = (activeTabId) => {
                // Deactivate all tabs
                tabButtons.forEach(button => {
                    button.setAttribute('aria-selected', 'false');
                    button.classList.remove('border-blue-700', 'text-blue-700', 'bg-white');
                    button.classList.add('border-transparent', 'text-[#1A1A1A]', 'hover:border-gray-500');
                });

                // Hide all content
                tabContents.forEach(content => {
                    content.classList.add('hidden');
                });

                // Activate the selected tab and show its content
                const activeTabButton = document.querySelector(`[data-tab-content="${activeTabId}"]`);
                const activeTabContent = document.getElementById(activeTabId);

                if (activeTabButton && activeTabContent) {
                    activeTabButton.setAttribute('aria-selected', 'true');
                    activeTabButton.classList.add('border-blue-700', 'text-blue-700', 'bg-white');
                    activeTabButton.classList.remove('border-transparent', 'text-[#1A1A1A]', 'hover:border-gray-500');
                    activeTabContent.classList.remove('hidden');
                    activeTabContent.focus(); // Set focus to the active tab panel for accessibility
                }
            };

            // Set up event listeners for tab buttons
            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const contentId = button.getAttribute('data-tab-content');
                    activateTab(contentId);
                });
            });

            // Initial check: Activate the first tab if no other is active
            if (document.querySelector('.tab-button[aria-selected="true"]')) {
                // Tab one is set to active by default in the HTML, no action needed here.
            } else if (tabButtons.length > 0) {
                 // Fallback if initial HTML state is incorrect
                activateTab(tabButtons[0].getAttribute('data-tab-content'));
            }
        });
    </script>
</body>
</html>
