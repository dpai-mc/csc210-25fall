<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Circuits: XOR Comparator</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        // MANDATORY: Configure Tailwind to include the Typography plugin.
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                },
            },
            plugins: [
                require('@tailwindcss/typography'),
            ],
        }
    </script>
    <style>
        /* STRICT LIGHT THEME MANDATE: Overrides dark mode settings */
        html { 
            font-family: 'Inter', sans-serif; 
            background-color: #FDFBF8; 
            color: #1A1A1A; 
        }
        @media (prefers-color-scheme: dark) {
            html {
                background-color: #FDFBF8 !important; 
                color: #1A1A1A !important; 
            }
        }
        /* Custom class for Skip Link (visible on focus) */
        .skip-link {
            position: absolute;
            top: -40px;
            left: 0;
            background: #1A1A1A;
            color: white;
            padding: 8px;
            z-index: 100;
            transition: top 0.3s;
        }
        .skip-link:focus {
            top: 0;
        }
    </style>
</head>
<body class="bg-[#FDFBF8] text-[#1A1A1A]">
    <a id="skip-to-content" href="#main-content" class="skip-link" tabindex="0">Skip to Content</a>
    
    <header class="bg-white shadow-md p-4 sticky top-0 z-10">
        <div class="max-w-7xl mx-auto">
            <h1 class="text-2xl font-bold text-[#1A1A1A]">Circuits: XOR Comparator</h1>
        </div>
    </header>

    <main id="main-content" class="p-4 sm:p-6 lg:p-8 max-w-7xl mx-auto">
        
        <h1 class="text-4xl font-extrabold mb-8 text-blue-700">Circuits: XOR Comparator</h1>

        <section class="mb-8 p-6 bg-white rounded-xl shadow-lg">
            <div class="prose max-w-none">
                <h2 class="text-3xl font-bold mt-0 mb-4">XOR Comparator Functionality</h2>
                <p>For this function, we want to create a circuit that will do **three different things**:</p>
                <ol class="list-decimal list-inside space-y-2">
                    <li>Output the results from a bit-wise **Exclusive OR** for two 8-bit inputs. This will be an **8-bit output**.</li>
                    <li>Output if the two 8-bit inputs are **equal**. This will be a **1-bit output** of 1 if equal and 0 if not equal.</li>
                    <li>Output if input "**a**" is **larger** than input "**b**" - over all 8 bits. This will be a **1-bit output** of 1 if "a" is larger than "b" and 0 if equal or less than "b".</li>
                </ol>
                <p>We want to work our way up to an 8-bit version by progressing as follows:</p>
            </div>
        </section>

        <div class="mb-8">
            <nav class="flex overflow-x-auto whitespace-nowrap border-b border-gray-300" role="tablist" aria-label="XOR Comparator Steps">
                <button 
                    id="tab-comparing-2-bits-button" 
                    class="tab-button px-4 py-2 text-lg font-medium border-b-2 border-blue-700 text-blue-700 bg-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-700"
                    role="tab" 
                    aria-controls="tab-comparing-2-bits" 
                    aria-selected="true"
                    data-tab-content="tab-comparing-2-bits"
                >
                    Comparing 2 bits
                </button>
                
                <button 
                    id="tab-recognizing-higher-bits-button" 
                    class="tab-button px-4 py-2 text-lg font-medium border-b-2 border-transparent text-[#1A1A1A] hover:border-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-700"
                    role="tab" 
                    aria-controls="tab-recognizing-higher-bits" 
                    aria-selected="false"
                    data-tab-content="tab-recognizing-higher-bits"
                >
                    Recognizing Higher Bits
                </button>

                <button 
                    id="tab-chaining-for-8-bits-button" 
                    class="tab-button px-4 py-2 text-lg font-medium border-b-2 border-transparent text-[#1A1A1A] hover:border-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-700"
                    role="tab" 
                    aria-controls="tab-chaining-for-8-bits" 
                    aria-selected="false"
                    data-tab-content="tab-chaining-for-8-bits"
                >
                    Chaining for 8 bits
                </button>
            </nav>

            <div id="tab-comparing-2-bits" class="tab-content p-6 bg-white rounded-b-xl shadow-lg border border-t-0 border-gray-300" role="tabpanel" tabindex="0">
                <h2 class="text-2xl font-bold">Two-bit XOR Gate Properties</h2>
                <div class="prose max-w-none">
                    <p>The first thing we want to do is to look at the truth table for an **XOR Gate**, which gives us our primary XOR result:</p>
                    <div class="flex justify-center my-6">
                        <img src="images/xor-truth-table.png" alt="XOR Truth Table showing that output is 1 only when inputs are different" class="max-w-xs h-auto rounded-lg shadow-md border border-gray-300" />
                    </div>

                    <p>To get the **"Is Equal"** output, we need a 1 when inputs are the same, which is the exact opposite of XOR. This function is called **XNOR** (Exclusive NOR).</p>
                    <div class="flex justify-center my-6">
                        <img src="images/xnor-truth-table.png" alt="XNOR Truth Table showing that output is 1 only when inputs are the same" class="max-w-xs h-auto rounded-lg shadow-md border border-gray-300" />
                    </div>

                    <p>Next, we look at the basic **XOR Comparator circuit** for two bits. The value for "Equal" (or XNOR) is achieved by using a **NOT gate** on the XOR output.</p>
                    <div class="flex justify-center my-6">
                        <img src="images/xor-comparator-2-bit-circuit.png" alt="2-bit XOR Comparator Circuit Diagram showing NOT gate on XOR output to determine if inputs are equal" class="max-w-md h-auto rounded-lg shadow-md border border-gray-300" />
                    </div>

                    <p>To complete the function for a single bit, we need to add the logic for **"Is Larger"**. For a single bit, 'a' is larger than 'b' only if 'a' is 1 and 'b' is 0. This is a simple **AND NOT** operation ($\mathbf{a \cdot \neg b}$).</p>
                    <div class="flex justify-center my-6">
                        <img src="images/2-bit-comparator-le.png" alt="The complete 2-bit comparator with XOR result, Is Equal (E), and Is Larger (L) outputs" class="max-w-lg h-auto rounded-lg shadow-md border border-gray-300" />
                    </div>
                </div>
            </div>

            <div id="tab-recognizing-higher-bits" class="tab-content hidden p-6 bg-white rounded-b-xl shadow-lg border border-t-0 border-gray-300" role="tabpanel" tabindex="0">
                <h2 class="text-2xl font-bold">Chaining for "Is Larger" and "Is Equal"</h2>
                <div class="prose max-w-none">
                    <p>To compare two multi-bit numbers, we must process the bits from **most significant (Bit 7) to least significant (Bit 0)**. We need to create a single-bit comparator that can be **chained** to its neighbors.</p>
                    
                    <p>This single-bit comparator requires two additional inputs to enable chaining from the previous, more significant bit:</p>
                    <ul class="list-disc list-inside space-y-1">
                        <li>**pl** (Prior Is Larger): Input from the next higher bit comparison. If this is 1, the result is already decided.</li>
                        <li>**pe** (Prior Is Equal): Input from the next higher bit comparison. If this is 0, the result is already decided.</li>
                    </ul>

                    <h3 class="text-xl font-semibold mt-4 mb-2">The 'Is Larger' Logic ($L$)</h3>
                    <p>The core logic for the **"Is Larger"** output ($L$) for the current bit comparison must account for the prior bit's status. The formula is:</p>
                    <p class="text-xl font-mono p-3 bg-gray-100 rounded">
                        $$ L = (a \cdot \neg b \cdot pe) + pl $$
                    </p>
                    <p>This is implemented using an **OR** gate driven by two paths:</p>
                    <div class="flex justify-center my-6">
                        <img src="images/is-larger-logic-detail.png" alt="Detailed logic circuit for the Is Larger (L) output using AND and OR gates to combine current bit comparison (a and not b) with the prior is equal (pe) and prior is larger (pl) inputs" class="max-w-xl h-auto rounded-lg shadow-md border border-gray-300" />
                    </div>

                    <h3 class="text-xl font-semibold mt-4 mb-2">The Complete Single-Bit Component</h3>
                    <p>The final single-bit comparator integrates the XOR output, the XNOR (Is Equal) logic, and the new chaining logic for 'Is Larger' (L) and 'Is Equal' (E). We also need the current 'Is Equal' (E) output to feed the next less significant bit's 'Prior Is Equal' (pe) input.</p>
                    <div class="flex justify-center my-6">
                        <img src="images/single-bit-comparator-with-chaining.png" alt="Single-bit XOR Comparator with chaining inputs for prior larger (pl) and prior equal (pe)" class="max-w-xl h-auto rounded-lg shadow-md border border-gray-300" />
                    </div>
                    
                    <p>Once your single-bit circuit is functional, create an appearance for it to use as a component:</p>
                    <div class="flex justify-center my-6">
                        <img src="images/single-bit-component-appearance.png" alt="Circuit appearance of the single-bit comparator component with inputs A, B, pl, pe and outputs O, l, e" class="max-w-xs h-auto rounded-lg shadow-md border border-gray-300" />
                    </div>
                </div>
            </div>

            <div id="tab-chaining-for-8-bits" class="tab-content hidden p-6 bg-white rounded-b-xl shadow-lg border border-t-0 border-gray-300" role="tabpanel" tabindex="0">
                <h2 class="text-2xl font-bold">The Complete 8-bit XOR Comparator</h2>
                <div class="prose max-w-none">
                    <p>To create the full 8-bit comparator, you chain **eight** of the single-bit comparator circuits from the previous step. The connections for **"is larger"** and **"is equal"** are from the **Most Significant Bit (MSB) down to the Least Significant Bit (LSB)**.</p>
                    <ul class="list-disc list-inside space-y-2">
                        <li>The constant inputs for **Bit 7 (MSB)** are: **pl** = **Ground (0)** and **pe** = **Constant 1**. (Since there is no "prior" bit, we assume they were equal and not larger).</li>
                        <li>The outputs from Bit $N$ (l and e) connect directly to the **pl** and **pe** inputs of Bit $N-1$.</li>
                    </ul>
                    <p>A detail of the chaining connections between two components is shown below:</p>
                    <div class="flex justify-center my-6">
                        <img src="images/chaining-detail-diagram.png" alt="Detail diagram showing l and e outputs of one comparator feeding the pl and pe inputs of the next lower comparator" class="max-w-2xl h-auto rounded-lg shadow-md border border-gray-300" />
                    </div>
                    
                    <p>The final outputs for the comparison flags are taken from the evaluation outputs of the **Bit 0** comparison (the LSB).</p>
                    <div class="flex justify-center my-6">
                        <img src="images/8-bit-xor-comparator-chained-circuit.png" alt="8-bit XOR comparator chained circuit with is larger and is equal evaluation" class="max-w-4xl h-auto rounded-lg shadow-md border border-gray-300" />
                    </div>
                    
                    <h3 class="text-xl font-semibold mt-6 mb-2">Component Pin Definitions</h3>
                    <p>For the single-bit comparator circuit components shown above, the pins represent:</p>
                    <div class="p-4 bg-gray-50 border border-gray-200 rounded-lg">
                        <p style="padding-left: 40px;">a = 1-bit input<br />b = 1-bit input<br />pl = prior "is larger"<br />pe = prior "is equal"<br />l = "is larger" output<br />e = "is equal" output<br />o = XOR result</p>
                    </div>

                    <p class="mt-6">Make sure to create a new circuit appearance after chaining and verifying that it works, for integration into higher level assemblies. One possible representation is shown below:</p>
                    <div class="flex justify-center my-6">
                        <img src="images/xor-comparator-circuit-appearance.png" alt="Circuit appearance for the 8-bit XOR Comparator" class="max-w-xs h-auto rounded-lg shadow-md border border-gray-300" />
                    </div>
                </div>
            </div>
        </div>
        <footer class="mt-8 pt-4 border-t border-gray-300 text-center text-sm text-gray-500">
            <div class="prose max-w-none mx-auto">
                <p class="text-xs italic">Ref: This project adapted from "Design a CPU" by Ross McGowan (On Udemy)</p>
            </div>
        </footer>
    </main>
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const tabButtons = document.querySelectorAll('.tab-button');
            const tabContents = document.querySelectorAll('.tab-content');

            const activateTab = (activeTabId) => {
                // Deactivate all tabs
                tabButtons.forEach(button => {
                    button.setAttribute('aria-selected', 'false');
                    button.classList.remove('border-blue-700', 'text-blue-700', 'bg-white');
                    button.classList.add('border-transparent', 'text-[#1A1A1A]', 'hover:border-gray-500');
                });

                // Hide all content
                tabContents.forEach(content => {
                    content.classList.add('hidden');
                });

                // Activate the selected tab and show its content
                const activeTabButton = document.querySelector(`[data-tab-content="${activeTabId}"]`);
                const activeTabContent = document.getElementById(activeTabId);

                if (activeTabButton && activeTabContent) {
                    activeTabButton.setAttribute('aria-selected', 'true');
                    activeTabButton.classList.add('border-blue-700', 'text-blue-700', 'bg-white');
                    activeTabButton.classList.remove('border-transparent', 'text-[#1A1A1A]', 'hover:border-gray-500');
                    activeTabContent.classList.remove('hidden');
                    activeTabContent.focus(); // Set focus to the active tab panel for accessibility
                }
            };

            // Set up event listeners for tab buttons
            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const contentId = button.getAttribute('data-tab-content');
                    activateTab(contentId);
                });
            });

            // Initial check: Activate the first tab if no other is active
            if (document.querySelector('.tab-button[aria-selected="true"]')) {
                // Tab one is set to active by default in the HTML, no action needed here.
            } else if (tabButtons.length > 0) {
                 // Fallback if initial HTML state is incorrect
                activateTab(tabButtons[0].getAttribute('data-tab-content'));
            }
        });
    </script>
</body>
</html>
