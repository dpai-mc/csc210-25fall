<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Control Unit for ALU Instruction</title>
    <script src="https://cdn.tailwindcss.com?plugins=typography"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        primary: '#1A1A1A',
                        accent: '#2563EB', // Royal Blue
                        bg: '#FDFBF8',
                    }
                }
            }
        }
    </script>
    <style>
        /* Custom focus styles for accessibility */
        *:focus-visible {
            outline: 3px solid #2563EB;
            outline-offset: 2px;
        }
        .tab-active {
            border-bottom: 3px solid #2563EB;
            color: #2563EB;
            font-weight: 600;
        }
        .tab-inactive {
            border-bottom: 3px solid transparent;
            color: #6B7280;
        }
        .tab-inactive:hover {
            color: #1A1A1A;
            border-bottom-color: #D1D5DB;
        }
    </style>
</head>
<body class="bg-[#FDFBF8] text-[#1A1A1A] font-sans antialiased min-h-screen flex flex-col">

    <!-- Skip to Content -->
    <a href="#main-content" class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 bg-accent text-white px-4 py-2 rounded shadow-lg z-50">
        Skip to Content
    </a>

    <!-- Header -->
    <header class="bg-white border-b border-gray-200 shadow-sm">
        <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
            <h1 class="text-3xl font-bold text-gray-900">Control Unit for ALU Instruction</h1>
        </div>
    </header>

    <!-- Main Content -->
    <main id="main-content" class="flex-grow max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-8 w-full">
        
        <!-- Introduction -->
        <section class="prose prose-lg max-w-none mb-10 text-gray-800">
            <p>
                Before we begin, we first have to define how our Instruction Register works for an ALU Instruction. 
                Then, we will review a couple of new items that you will see in diagrams. 
                Third, we will look at the actual diagram of the Control Unit for this ALU instruction demo. 
                Fourth, we will examine the CPU diagram for this simplified ALU instruction. 
                Lastly, I will show how the circuit works in a short video.
            </p>
        </section>

        <!-- Tabs Container -->
        <div class="bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
            <!-- Tab List -->
            <div class="border-b border-gray-200 overflow-x-auto">
                <nav class="flex -mb-px" aria-label="Tabs" role="tablist">
                    <button onclick="switchTab('tab1')" id="btn-tab1" role="tab" aria-selected="true" aria-controls="tab1" class="tab-active whitespace-nowrap py-4 px-6 text-sm font-medium transition-colors duration-200 focus:outline-none">
                        ALU Instruction
                    </button>
                    <button onclick="switchTab('tab2')" id="btn-tab2" role="tab" aria-selected="false" aria-controls="tab2" class="tab-inactive whitespace-nowrap py-4 px-6 text-sm font-medium transition-colors duration-200 focus:outline-none">
                        New Items
                    </button>
                    <button onclick="switchTab('tab3')" id="btn-tab3" role="tab" aria-selected="false" aria-controls="tab3" class="tab-inactive whitespace-nowrap py-4 px-6 text-sm font-medium transition-colors duration-200 focus:outline-none">
                        Control Unit
                    </button>
                    <button onclick="switchTab('tab4')" id="btn-tab4" role="tab" aria-selected="false" aria-controls="tab4" class="tab-inactive whitespace-nowrap py-4 px-6 text-sm font-medium transition-colors duration-200 focus:outline-none">
                        CPU Diagram
                    </button>
                    <button onclick="switchTab('tab5')" id="btn-tab5" role="tab" aria-selected="false" aria-controls="tab5" class="tab-inactive whitespace-nowrap py-4 px-6 text-sm font-medium transition-colors duration-200 focus:outline-none">
                        Video
                    </button>
                </nav>
            </div>

            <!-- Tab 1: ALU Instruction -->
            <div id="tab1" role="tabpanel" aria-labelledby="btn-tab1" class="p-6 sm:p-8 focus:outline-none" tabindex="0">
                <div class="prose max-w-none">
                    <h2>ALU Instruction Breakdown</h2>
                    <p>The ALU instruction is an 8-bit value broken down as follows:</p>
                    
                    <!-- Responsive Table Container -->
                    <div class="overflow-x-auto my-6 border rounded-lg">
                        <table class="min-w-[600px] w-full text-sm text-center">
                            <thead class="bg-gray-50 text-gray-700 uppercase">
                                <tr>
                                    <th class="px-4 py-3 border-b">Bit 0</th>
                                    <th class="px-4 py-3 border-b">Bit 1</th>
                                    <th class="px-4 py-3 border-b">Bit 2</th>
                                    <th class="px-4 py-3 border-b">Bit 3</th>
                                    <th class="px-4 py-3 border-b">Bit 4</th>
                                    <th class="px-4 py-3 border-b">Bit 5</th>
                                    <th class="px-4 py-3 border-b">Bit 6</th>
                                    <th class="px-4 py-3 border-b">Bit 7</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="divide-x divide-gray-200">
                                    <td class="px-4 py-3">1 (ALU Instr)</td>
                                    <td class="px-4 py-3 bg-blue-50">Op Code</td>
                                    <td class="px-4 py-3 bg-blue-50">Op Code</td>
                                    <td class="px-4 py-3 bg-blue-50">Op Code</td>
                                    <td class="px-4 py-3 bg-green-50">Reg A</td>
                                    <td class="px-4 py-3 bg-green-50">Reg A</td>
                                    <td class="px-4 py-3 bg-orange-50">Reg B</td>
                                    <td class="px-4 py-3 bg-orange-50">Reg B</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h3>Bit Definitions</h3>
                    <ul class="list-disc pl-5 space-y-2">
                        <li><strong>Bit 0:</strong> When this is 1, we have an ALU Instruction. When it is 0, we do not.</li>
                        <li><strong>Bits 1-3:</strong> The ALU operation code (based upon the table below).</li>
                        <li><strong>Bits 4-5:</strong> Define which Register (0-3) will be used for the first register (Reg A).</li>
                        <li><strong>Bits 6-7:</strong> Define which Register (0-3) will be used for the second register (Reg B).</li>
                    </ul>
                    <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 my-4">
                        <p class="m-0 text-sm text-yellow-800"><strong>NOTE:</strong> The ADD operation takes the value held in the register defined by bits 4 & 5, adds it to the value in the register defined by bits 6 & 7, then stores the results in the register defined by bits 6 & 7.</p>
                    </div>

                    <h3>ALU Operations Table</h3>
                    <div class="overflow-x-auto my-6 border rounded-lg max-w-md">
                        <table class="w-full text-sm text-center divide-y divide-gray-200">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-4 py-3">Operation</th>
                                    <th class="px-4 py-3">Bit 1</th>
                                    <th class="px-4 py-3">Bit 2</th>
                                    <th class="px-4 py-3">Bit 3</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200">
                                <tr><td class="px-4 py-2 font-medium">ADD</td><td>0</td><td>0</td><td>0</td></tr>
                                <tr><td class="px-4 py-2 font-medium">SHR</td><td>0</td><td>0</td><td>1</td></tr>
                                <tr><td class="px-4 py-2 font-medium">SHL</td><td>0</td><td>1</td><td>0</td></tr>
                                <tr><td class="px-4 py-2 font-medium">NOT</td><td>0</td><td>1</td><td>1</td></tr>
                                <tr><td class="px-4 py-2 font-medium">AND</td><td>1</td><td>0</td><td>0</td></tr>
                                <tr><td class="px-4 py-2 font-medium">OR</td> <td>1</td><td>0</td><td>1</td></tr>
                                <tr><td class="px-4 py-2 font-medium">XOR</td><td>1</td><td>1</td><td>0</td></tr>
                                <tr><td class="px-4 py-2 font-medium">CMP</td><td>1</td><td>1</td><td>1</td></tr>
                            </tbody>
                        </table>
                    </div>

                    <h3>Register Codes (Reg A and Reg B)</h3>
                    <div class="overflow-x-auto my-6 border rounded-lg max-w-sm">
                        <table class="w-full text-sm text-center divide-y divide-gray-200">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-4 py-3">Bit 4 / 6</th>
                                    <th class="px-4 py-3">Bit 5 / 7</th>
                                    <th class="px-4 py-3">Register</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200">
                                <tr><td>0</td><td>0</td><td class="font-medium">R0</td></tr>
                                <tr><td>0</td><td>1</td><td class="font-medium">R1</td></tr>
                                <tr><td>1</td><td>0</td><td class="font-medium">R2</td></tr>
                                <tr><td>1</td><td>1</td><td class="font-medium">R3</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Tab 2: New Items -->
            <div id="tab2" role="tabpanel" aria-labelledby="btn-tab2" class="hidden p-6 sm:p-8 focus:outline-none" tabindex="0">
                <div class="prose max-w-none">
                    <h2>New Items on the Diagram</h2>
                    <p>Some new elements you will see in this diagram and future ones include:</p>

                    <h3 class="text-xl font-semibold mt-6">1. Tunnel</h3>
                    <p>A tunnel is like a wire jumper. If you use two of them and give them the same text label, they act as if they are physically connected. You can use this to clean up your circuit diagram so you don't have as many wires crossing one another.</p>
                    
                    <figure class="my-6">
                        <img src="images/tunnel-icon.png" alt="Icon representing a Tunnel in Logisim" class="rounded shadow-md max-w-xs border border-gray-200">
                        <figcaption class="text-sm text-gray-500 mt-2">Figure 1: Tunnel wiring element</figcaption>
                    </figure>

                    <p><strong>Video Explanation:</strong> This video explains how "tunnels" work in Logisim.</p>
                    <div class="aspect-w-16 aspect-h-9 my-4">
                        <iframe class="w-full h-64 md:h-96 rounded-lg shadow-md" src="https://www.youtube.com/embed/Z6usYyBZaF0" title="Logisim Tunnel Explanation" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                    </div>

                    <hr class="my-8 border-gray-200">

                    <h3 class="text-xl font-semibold">2. Clk (Clock)</h3>
                    <p>The clock wiring element simulates a clock pulse (oscillating 1's and 0's). It cycles between 1 and 0 every time you click on it. You will see this in the example videos that follow.</p>
                    
                    <figure class="my-6">
                        <img src="images/clock-element.jpg" alt="Wiring element to simulate a Clock pulse" class="rounded shadow-md max-w-xs border border-gray-200">
                        <figcaption class="text-sm text-gray-500 mt-2">Figure 2: Clock wiring element</figcaption>
                    </figure>
                </div>
            </div>

            <!-- Tab 3: Control Unit Diagram -->
            <div id="tab3" role="tabpanel" aria-labelledby="btn-tab3" class="hidden p-6 sm:p-8 focus:outline-none" tabindex="0">
                <div class="prose max-w-none">
                    <h2>ALU Instruction Control Unit Diagram</h2>
                    <p>The actual Control Unit for this system is shown below. Please note the following elements have been added that were not present in previous versions:</p>
                    
                    <ul class="list-disc pl-5 space-y-1">
                        <li><strong>IO CLK_E:</strong> Not using here. This is an enable for IO CLK.</li>
                        <li><strong>IO CLKS_S:</strong> Not using here. This is a set for IO CLKS.</li>
                        <li><strong>FLAGS_S:</strong> Not using here. This is a set for FLAGS.</li>
                        <li><strong>ALU_0, ALU_1, ALU_2:</strong> The three ALU Instruction Code bits.</li>
                        <li><strong>REGA_E, REGB_E, REGB_S:</strong> Necessary control signals to get data from/to the registers specified in the ALU instruction.</li>
                        <li><strong>2x4 Decoders:</strong> Used to decode the values in the ALU Instruction for REGA and REGB to select the correct register (R0-R3).</li>
                    </ul>

                    <figure class="my-8">
                        <img src="images/control-unit-diagram.jpg" alt="Circuit diagram for ALU Instruction Control Unit showing decoders and enable lines" class="w-full h-auto rounded shadow-md border border-gray-200">
                        <figcaption class="text-sm text-gray-500 mt-2 text-center">Figure 3: Control Unit Circuit Diagram</figcaption>
                    </figure>
                </div>
            </div>

            <!-- Tab 4: CPU Diagram -->
            <div id="tab4" role="tabpanel" aria-labelledby="btn-tab4" class="hidden p-6 sm:p-8 focus:outline-none" tabindex="0">
                <div class="prose max-w-none">
                    <h2>CPU for ALU Instruction</h2>
                    <p>The temporary modifications included in this diagram are:</p>
                    <ul class="list-disc pl-5 space-y-2">
                        <li>Removing inputs R3 and R2 from the BUS and connecting them to 8-bit inputs that we can manually change to test our addition.</li>
                        <li>Making the "set" input for R3 and R2 a constant value of 1.</li>
                        <li>Removing IR from the BUS so we can manually set the value.</li>
                    </ul>

                    <figure class="my-8">
                        <img src="images/cpu-alu-layout.jpg" alt="ALU Instruction CPU Layout Diagram showing modified inputs for testing" class="w-full h-auto rounded shadow-md border border-gray-200">
                        <figcaption class="text-sm text-gray-500 mt-2 text-center">Figure 4: CPU Layout Diagram</figcaption>
                    </figure>
                </div>
            </div>

            <!-- Tab 5: Video -->
            <div id="tab5" role="tabpanel" aria-labelledby="btn-tab5" class="hidden p-6 sm:p-8 focus:outline-none" tabindex="0">
                <div class="prose max-w-none">
                    <h2>Video Description of Operation</h2>
                    <p>The following video walks through the detailed operation of the ALU instruction within the circuit.</p>
                    
                    <div class="aspect-w-16 aspect-h-9 my-6">
                        <iframe class="w-full h-64 md:h-[500px] rounded-lg shadow-md" src="https://www.youtube.com/embed/Ni2EHHkhHms" title="Demonstration of ALU Instruction" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                    </div>
                </div>
            </div>

        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-white border-t border-gray-200 mt-auto">
        <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
            <p class="text-center text-sm text-gray-500">
                &copy; 2025 Instructional Content. All rights reserved.
            </p>
        </div>
    </footer>

    <script>
        function switchTab(tabId) {
            // Get all tabs and panels
            const tabs = document.querySelectorAll('[role="tab"]');
            const panels = document.querySelectorAll('[role="tabpanel"]');

            // Loop through tabs to update state
            tabs.forEach(tab => {
                const isSelected = tab.getAttribute('onclick').includes(tabId);
                tab.setAttribute('aria-selected', isSelected);
                
                if (isSelected) {
                    tab.classList.remove('tab-inactive');
                    tab.classList.add('tab-active');
                } else {
                    tab.classList.remove('tab-active');
                    tab.classList.add('tab-inactive');
                }
            });

            // Loop through panels to show/hide
            panels.forEach(panel => {
                if (panel.id === tabId) {
                    panel.classList.remove('hidden');
                } else {
                    panel.classList.add('hidden');
                }
            });
        }

        // Handle keyboard navigation for tabs
        document.addEventListener('keydown', function(e) {
            const currentTab = document.activeElement;
            if (currentTab.getAttribute('role') !== 'tab') return;

            const tabs = Array.from(document.querySelectorAll('[role="tab"]'));
            const index = tabs.indexOf(currentTab);
            
            let nextIndex = null;

            if (e.key === 'ArrowRight') {
                nextIndex = (index + 1) % tabs.length;
            } else if (e.key === 'ArrowLeft') {
                nextIndex = (index - 1 + tabs.length) % tabs.length;
            }

            if (nextIndex !== null) {
                e.preventDefault();
                tabs[nextIndex].focus();
                tabs[nextIndex].click();
            }
        });
    </script>
</body>
</html>
