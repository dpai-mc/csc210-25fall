<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Control Unit for Jump IF Instruction</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'bg-light': '#FDFBF8',
                        'text-dark': '#1A1A1A'
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif']
                    }
                }
            },
            plugins: [require('@tailwindcss/typography')],
            corePlugins: {
                preflight: true
            }
        };
    </script>
    <style>
        /* Disable dark mode and force light theme */
        :root {
            color-scheme: light;
        }
        html, body {
            background-color: #FDFBF8 !important;
            color: #1A1A1A !important;
        }
        @media (prefers-color-scheme: dark) {
            html, body {
                background-color: #FDFBF8 !important;
                color: #1A1A1A !important;
            }
        }
        /* Enhanced focus states for accessibility */
        *:focus-visible {
            outline: 2px solid #2563eb !important;
            outline-offset: 2px !important;
        }
        /* Skip to content link */
        .skip-to-content {
            position: absolute;
            top: -40px;
            left: 0;
            background: #2563eb;
            color: white;
            padding: 8px 16px;
            z-index: 100;
            text-decoration: none;
            border-radius: 0 0 4px 0;
        }
        .skip-to-content:focus {
            top: 0;
        }
        /* Tab styling */
        [role="tab"] {
            cursor: pointer;
            transition: all 0.3s ease;
        }
        [role="tab"][aria-selected="true"] {
            border-bottom-width: 3px;
            border-bottom-color: #2563eb;
        }
        [role="tab"][aria-selected="false"] {
            border-bottom-width: 2px;
            border-bottom-color: #e5e7eb;
        }
        [role="tab"]:hover {
            background-color: #f3f4f6;
        }
        [role="tabpanel"] {
            display: none;
        }
        [role="tabpanel"][aria-hidden="false"] {
            display: block;
        }
        /* Table styling */
        table {
            border-collapse: collapse;
            width: 100%;
            margin: 16px 0;
        }
        th, td {
            border: 1px solid #d1d5db;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #f3f4f6;
            font-weight: 600;
            color: #1a1a1a;
        }
        tbody tr:nth-child(even) {
            background-color: #fafafa;
        }
    </style>
</head>
<body class="bg-bg-light text-text-dark font-sans">
    <!-- Skip to Content Link -->
    <a href="#main-content" class="skip-to-content">Skip to Main Content</a>

    <!-- Header -->
    <header class="bg-white shadow-sm border-b border-gray-200">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <h1 class="text-3xl sm:text-4xl font-bold text-text-dark mb-2">Control Unit for Jump IF Instruction</h1>
            <p class="text-lg text-gray-700">Before we begin, we first need to define how our Instruction Register works for Jump IF Instructions.</p>
        </div>
    </header>

    <!-- Main Content -->
    <main id="main-content" class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
        
        <!-- Tabbed Interface -->
        <div class="mb-12">
            <!-- Tab List -->
            <div role="tablist" class="flex flex-wrap gap-0 border-b-2 border-gray-300 mb-8" aria-label="Instructional Content Tabs">
                <button 
                    role="tab"
                    aria-selected="true"
                    aria-controls="panel-jump-if-instructions"
                    id="tab-jump-if-instructions"
                    class="px-4 sm:px-6 py-3 text-base font-medium text-gray-700 hover:text-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">
                    Jump IF Instructions
                </button>
                <button 
                    role="tab"
                    aria-selected="false"
                    aria-controls="panel-control-unit"
                    id="tab-control-unit"
                    class="px-4 sm:px-6 py-3 text-base font-medium text-gray-700 hover:text-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">
                    Jump IF Control Unit Diagram
                </button>
                <button 
                    role="tab"
                    aria-selected="false"
                    aria-controls="panel-cpu-diagram"
                    id="tab-cpu-diagram"
                    class="px-4 sm:px-6 py-3 text-base font-medium text-gray-700 hover:text-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">
                    CPU for Jump IF Instruction
                </button>
                <button 
                    role="tab"
                    aria-selected="false"
                    aria-controls="panel-video"
                    id="tab-video"
                    class="px-4 sm:px-6 py-3 text-base font-medium text-gray-700 hover:text-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">
                    Jump IF Video
                </button>
            </div>

            <!-- Tab Panels -->
            
            <!-- Panel 1: Jump IF Instructions -->
            <div 
                role="tabpanel"
                id="panel-jump-if-instructions"
                aria-labelledby="tab-jump-if-instructions"
                aria-hidden="false"
                class="prose prose-sm sm:prose max-w-none">
                
                <h2 class="text-2xl font-bold mt-0 mb-6">Jump IF Instructions</h2>
                
                <p>The Operation instruction is an 8-bit value that is broken down as follows:</p>

                <!-- Instruction Format Table -->
                <div class="overflow-x-auto">
                    <table>
                        <thead>
                            <tr>
                                <th>bit 0</th>
                                <th>bit 1</th>
                                <th>bit 2</th>
                                <th>bit 3</th>
                                <th>bit 4</th>
                                <th>bit 5</th>
                                <th>bit 6</th>
                                <th>bit 7</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>0 for Non-ALU Instr.</td>
                                <td>1</td>
                                <td>0</td>
                                <td><strong>1</strong></td>
                                <td>C</td>
                                <td>A</td>
                                <td>E</td>
                                <td>Z</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <h3 class="text-xl font-bold mt-8 mb-4">Bit Definitions</h3>
                <p><strong>bit 0:</strong> When this is 0, we have a non-ALU instruction (such as Load, Store, or Jump IF)</p>
                <p><strong>bits 1-3:</strong> Are 101 for a Jump IF instruction</p>
                <p><strong>bits 4-7:</strong> Are flags for the jump instruction with the following 16 possible combinations</p>

                <h3 class="text-xl font-bold mt-8 mb-4">Jump IF Flag Definitions</h3>
                <p>The values for bits 4-7 are all attached to ALU flags as follows:</p>
                <ul>
                    <li><strong>C</strong> — Carry Flag is set (Carry = 1)</li>
                    <li><strong>A</strong> — A is greater than B in ALU</li>
                    <li><strong>E</strong> — A equals B in ALU</li>
                    <li><strong>Z</strong> — Zero Flag is set (Zero = 1)</li>
                </ul>

                <p>This allows for 16 possible combinations:</p>

                <!-- Jump Conditions Table -->
                <div class="overflow-x-auto">
                    <table>
                        <thead>
                            <tr>
                                <th style="width: 10%; text-align: center;">C</th>
                                <th style="width: 10%; text-align: center;">A</th>
                                <th style="width: 10%; text-align: center;">E</th>
                                <th style="width: 10%; text-align: center;">Z</th>
                                <th style="width: 60%;">Jump Condition</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="text-align: center;">0</td>
                                <td style="text-align: center;">0</td>
                                <td style="text-align: center;">0</td>
                                <td style="text-align: center;">0</td>
                                <td><strong>No Jump</strong></td>
                            </tr>
                            <tr>
                                <td style="text-align: center;">0</td>
                                <td style="text-align: center;">0</td>
                                <td style="text-align: center;">0</td>
                                <td style="text-align: center;">1</td>
                                <td><strong>JZ</strong> — Jump if ALU Zero Flag is set (= 1)</td>
                            </tr>
                            <tr>
                                <td style="text-align: center;">0</td>
                                <td style="text-align: center;">0</td>
                                <td style="text-align: center;">1</td>
                                <td style="text-align: center;">0</td>
                                <td><strong>JE</strong> — Jump if ALU Equals Flag is set (= 1)</td>
                            </tr>
                            <tr>
                                <td style="text-align: center;">0</td>
                                <td style="text-align: center;">0</td>
                                <td style="text-align: center;">1</td>
                                <td style="text-align: center;">1</td>
                                <td><strong>JEZ</strong> — Jump if either Zero or Equals Flag in ALU is set</td>
                            </tr>
                            <tr>
                                <td style="text-align: center;">0</td>
                                <td style="text-align: center;">1</td>
                                <td style="text-align: center;">0</td>
                                <td style="text-align: center;">0</td>
                                <td><strong>JA</strong> — Jump if A > B</td>
                            </tr>
                            <tr>
                                <td style="text-align: center;">0</td>
                                <td style="text-align: center;">1</td>
                                <td style="text-align: center;">0</td>
                                <td style="text-align: center;">1</td>
                                <td><strong>JAZ</strong></td>
                            </tr>
                            <tr>
                                <td style="text-align: center;">0</td>
                                <td style="text-align: center;">1</td>
                                <td style="text-align: center;">1</td>
                                <td style="text-align: center;">0</td>
                                <td><strong>JAE</strong></td>
                            </tr>
                            <tr>
                                <td style="text-align: center;">0</td>
                                <td style="text-align: center;">1</td>
                                <td style="text-align: center;">1</td>
                                <td style="text-align: center;">1</td>
                                <td><strong>JAEZ</strong></td>
                            </tr>
                            <tr>
                                <td style="text-align: center;">1</td>
                                <td style="text-align: center;">0</td>
                                <td style="text-align: center;">0</td>
                                <td style="text-align: center;">0</td>
                                <td><strong>JC</strong></td>
                            </tr>
                            <tr>
                                <td style="text-align: center;">1</td>
                                <td style="text-align: center;">0</td>
                                <td style="text-align: center;">0</td>
                                <td style="text-align: center;">1</td>
                                <td><strong>JCZ</strong></td>
                            </tr>
                            <tr>
                                <td style="text-align: center;">1</td>
                                <td style="text-align: center;">0</td>
                                <td style="text-align: center;">1</td>
                                <td style="text-align: center;">0</td>
                                <td><strong>JCE</strong></td>
                            </tr>
                            <tr>
                                <td style="text-align: center;">1</td>
                                <td style="text-align: center;">0</td>
                                <td style="text-align: center;">1</td>
                                <td style="text-align: center;">1</td>
                                <td><strong>JCEZ</strong></td>
                            </tr>
                            <tr>
                                <td style="text-align: center;">1</td>
                                <td style="text-align: center;">1</td>
                                <td style="text-align: center;">0</td>
                                <td style="text-align: center;">0</td>
                                <td><strong>JCA</strong></td>
                            </tr>
                            <tr>
                                <td style="text-align: center;">1</td>
                                <td style="text-align: center;">1</td>
                                <td style="text-align: center;">0</td>
                                <td style="text-align: center;">1</td>
                                <td><strong>JCAZ</strong></td>
                            </tr>
                            <tr>
                                <td style="text-align: center;">1</td>
                                <td style="text-align: center;">1</td>
                                <td style="text-align: center;">1</td>
                                <td style="text-align: center;">0</td>
                                <td><strong>JCAE</strong></td>
                            </tr>
                            <tr>
                                <td style="text-align: center;">1</td>
                                <td style="text-align: center;">1</td>
                                <td style="text-align: center;">1</td>
                                <td style="text-align: center;">1</td>
                                <td><strong>JCAEZ</strong></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <h3 class="text-xl font-bold mt-8 mb-4">Jump IF Instruction Syntax</h3>
                <p>A Jump IF instruction jumps to the next byte in RAM if the specified conditions are met. It works like a conditional Jump Address instruction.</p>
                <p class="bg-blue-50 border-l-4 border-blue-400 p-4 rounded"><strong>Syntax:</strong> <code class="bg-white px-2 py-1">JMP**** ADDR</code></p>
                <p>Where the asterisks (<code>****</code>) represent the condition flags such as AE, C, CAE, etc.</p>
            </div>

            <!-- Panel 2: Control Unit Diagram -->
            <div 
                role="tabpanel"
                id="panel-control-unit"
                aria-labelledby="tab-control-unit"
                aria-hidden="true"
                class="prose prose-sm sm:prose max-w-none">
                
                <h2 class="text-2xl font-bold mt-0 mb-6">Jump IF Instruction Control Unit Diagram</h2>
                
                <p>The actual Control unit for this system is shown below. Please note that the following elements have been added and/or removed from the previous control units:</p>
                
                <ul>
                    <li>Since the Data Instruction is 101 (binary) or 4 (decimal), we only wire up the output for this value from the 3×8 decoder</li>
                    <li>We need to add 4-bit inputs for the C, A, E, and Z flags coming from the ALU</li>
                </ul>

                <figure class="my-8">
                    <img 
                        src="images/control-unit-jump-if.jpg" 
                        alt="Control Unit Circuit for Jump IF Instruction showing decoder and flag inputs from ALU"
                        width="800"
                        height="725"
                        class="w-full max-w-2xl mx-auto border border-gray-300 rounded">
                    <figcaption class="text-sm text-gray-600 mt-4 text-center">Figure 1: Control Unit Circuit for Jump IF Instruction</figcaption>
                </figure>
            </div>

            <!-- Panel 3: CPU Diagram -->
            <div 
                role="tabpanel"
                id="panel-cpu-diagram"
                aria-labelledby="tab-cpu-diagram"
                aria-hidden="true"
                class="prose prose-sm sm:prose max-w-none">
                
                <h2 class="text-2xl font-bold mt-0 mb-6">CPU for Jump IF Instruction</h2>
                
                <p>We need to add a way to get the status of the flags from the ALU to the Control Unit. We can do this by adding a 4-bit memory device. The images below show both the circuit diagram and how it appears when incorporated into the CPU diagram.</p>

                <!-- 4-bit Memory Circuit Table -->
                <div class="overflow-x-auto mb-8">
                    <table>
                        <thead>
                            <tr>
                                <th style="width: 50%; text-align: center;">4-bit Memory Circuit</th>
                                <th style="width: 50%; text-align: center;">FLAGS Appearance</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="width: 50%; text-align: center;">
                                    <figure class="my-4">
                                        <img 
                                            src="images/4bit-memory-circuit.jpg" 
                                            alt="4-bit Memory Circuit diagram showing flip-flop configuration"
                                            width="320"
                                            height="280"
                                            class="w-full max-w-sm mx-auto border border-gray-300 rounded">
                                        <figcaption class="text-xs text-gray-600 mt-2">Figure 2a: 4-bit Memory Circuit</figcaption>
                                    </figure>
                                </td>
                                <td style="width: 50%; text-align: center;">
                                    <figure class="my-4">
                                        <img 
                                            src="images/flags-appearance.jpg" 
                                            alt="FLAGS 4-bit Memory Circuit appearance for CPU integration"
                                            width="128"
                                            height="230"
                                            class="w-full max-w-sm mx-auto border border-gray-300 rounded">
                                        <figcaption class="text-xs text-gray-600 mt-2">Figure 2b: FLAGS Appearance</figcaption>
                                    </figure>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <h3 class="text-xl font-bold mt-8 mb-4">Temporary CPU Modifications</h3>
                <p>The following modifications have been made to the CPU for testing Jump IF Instructions:</p>
                
                <ul>
                    <li>Removing IR from the BUS so it can be manually set (IR_S is 1)</li>
                    <li>Setting both PC and RAM to a constant 1 for the "Set" for each</li>
                    <li>Removing RAM Input from the BUS so we can set it manually</li>
                    <li>For now, setting the "Set" for the Flags to 1</li>
                    <li>Added the FLAGS 4-bit circuit to the diagram</li>
                </ul>

                <figure class="my-8">
                    <img 
                        src="images/jump-if-cpu.jpg" 
                        alt="Jump IF CPU Circuit showing integrated FLAGS memory device and manual control points"
                        width="800"
                        height="579"
                        class="w-full max-w-2xl mx-auto border border-gray-300 rounded">
                    <figcaption class="text-sm text-gray-600 mt-4 text-center">Figure 3: Jump IF CPU Circuit</figcaption>
                </figure>
            </div>

            <!-- Panel 4: Video -->
            <div 
                role="tabpanel"
                id="panel-video"
                aria-labelledby="tab-video"
                aria-hidden="true"
                class="prose prose-sm sm:prose max-w-none">
                
                <h2 class="text-2xl font-bold mt-0 mb-6">Video Description of Operation</h2>
                
                <p>The following video walks through the details of Jump IF Instruction implementation and operation. Use the transcript panel to navigate the video or click any transcript line to jump to that moment.</p>
                
                <!-- Video and Transcript Container -->
                <div class="flex flex-col lg:flex-row gap-4 w-full my-6">
                  <!-- Video Player Section: 66% width on large screens -->
                  <div class="w-full lg:w-2/3 flex-shrink-0">
                    <div id="video-container" style="width: 100%; height: 0; padding-bottom: 56.25%; position: relative;">
                      <iframe id="youtube-player"
                              style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;"
                              src="https://www.youtube.com/embed/4MtMXlr2cPk?enablejsapi=1"
                              title="Jump IF Instruction: Detailed Walkthrough of Conditional Jumping and Flag Checking"
                              frameborder="0"
                              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                              referrerpolicy="strict-origin-when-cross-origin"
                              allowfullscreen>
                      </iframe>
                    </div>
                  </div>

                  <!-- Transcript Container Section: 33% width on large screens -->
                  <div class="w-full lg:w-1/3 flex-shrink-0">
                    <div id="transcript-container" class="h-96 overflow-y-scroll bg-white shadow-inner p-4 rounded-lg border border-gray-300">
                      <p class="text-gray-500 text-center">Loading transcript...</p>
                    </div>
                  </div>
                </div>

                <!-- CSS for highlighting the active line -->
                <style>
                  .active-transcript-line {
                    background-color: #f0f7ff;
                    font-weight: 600;
                    border-left: 4px solid #1e88e5;
                    padding-left: 12px;
                    transition: background-color 0.2s;
                  }
                </style>
            </div>

        </div>

    </main>

    <!-- Footer -->
    <footer class="bg-gray-100 border-t border-gray-300 mt-16 py-8">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center text-gray-600 text-sm">
            <p>&copy; 2024 Mendocino College Computer Science Department. Instructional materials for CSC210: Computer Organization & Architecture.</p>
        </div>
    </footer>

    <!-- Tab Switching and YouTube Transcript Sync JavaScript -->
    <script>
        // ============== TAB SWITCHING LOGIC ==============
        document.addEventListener('DOMContentLoaded', function() {
            const tabButtons = document.querySelectorAll('[role="tab"]');
            const tabPanels = document.querySelectorAll('[role="tabpanel"]');

            // Initialize all panels as hidden except the first
            tabPanels.forEach((panel, index) => {
                if (index === 0) {
                    panel.setAttribute('aria-hidden', 'false');
                } else {
                    panel.setAttribute('aria-hidden', 'true');
                }
            });

            // Add click event listeners to tabs
            tabButtons.forEach((button, index) => {
                button.addEventListener('click', function() {
                    // Deselect all tabs and hide all panels
                    tabButtons.forEach(btn => {
                        btn.setAttribute('aria-selected', 'false');
                    });
                    tabPanels.forEach(panel => {
                        panel.setAttribute('aria-hidden', 'true');
                    });

                    // Select clicked tab and show corresponding panel
                    button.setAttribute('aria-selected', 'true');
                    const panelId = button.getAttribute('aria-controls');
                    const panel = document.getElementById(panelId);
                    if (panel) {
                        panel.setAttribute('aria-hidden', 'false');
                    }

                    // Initialize transcript when video tab is opened
                    if (panelId === 'panel-video') {
                        initializeVideoTranscript();
                    }
                });

                // Add keyboard navigation for tabs (Arrow Left/Right)
                button.addEventListener('keydown', function(event) {
                    let targetIndex = index;

                    if (event.key === 'ArrowRight') {
                        event.preventDefault();
                        targetIndex = (index + 1) % tabButtons.length;
                    } else if (event.key === 'ArrowLeft') {
                        event.preventDefault();
                        targetIndex = (index - 1 + tabButtons.length) % tabButtons.length;
                    } else if (event.key === 'Home') {
                        event.preventDefault();
                        targetIndex = 0;
                    } else if (event.key === 'End') {
                        event.preventDefault();
                        targetIndex = tabButtons.length - 1;
                    }

                    if (targetIndex !== index) {
                        tabButtons[targetIndex].click();
                        tabButtons[targetIndex].focus();
                    }
                });
            });
        });

        // ============== YOUTUBE TRANSCRIPT SYNC LOGIC ==============
        const VIDEO_ID = '4MtMXlr2cPk';
        let player;
        let timeUpdater;
        let parsedTranscript = [];
        let videoInitialized = false;

        // --- RAW VTT CONTENT ---
        const vttContent = `WEBVTT

00:00.000 --> 00:15.440
okay in this video I want to talk about the jump if portion again it's a register jumping let's

00:15.440 --> 00:21.000
look at it real quick so basically what we have here and the jump if is usually after an

00:21.000 --> 00:29.680
arithmetic logic unit thing so we have 0 1 0 1 is our primary opcode so that's saying this is a jump

00:29.680 --> 00:36.760
if and then the last four bits stand for if it's 1 we're checking to see if the carry flag is set

00:36.760 --> 00:46.780
from the ALU meaning the carry out is 1 a a as large a is larger is 1 meaning a is larger e for

00:46.780 --> 00:56.500
equals a and B are equal and Z 0 meaning a the 0 5 okay is 1 so we actually have 16 different

00:56.500 --> 00:59.120
combinations of things that we can do

00:59.680 --> 01:09.040
note these are always or so if we have multiple slow like jump AZ means jump if a is greater than

01:09.040 --> 01:23.060
B or 0 okay not and but or okay and it jumps to the next address that's stored in ran okay so let

01:23.060 --> 01:28.900
me show you how that works okay so there's two things one when you look at this you should see

01:29.680 --> 01:36.940
I had to add this register here for flag so let's look at this in a little bit detail all it is is

01:36.940 --> 01:44.680
four bits I have four inputs to the from the left CAE and Z that are going to tie into the outputs

01:44.680 --> 01:51.880
from the ALU okay and then I have four output CAE and Z which are going to tie into my control unit

01:51.880 --> 01:59.560
okay so it's just those four beds and then I just made it look like this see a easy easy

01:59.680 --> 02:15.520
flag okay so we have to add that into our model so that we could do this all right so what we

02:15.520 --> 02:20.320
want to do okay I can't really manipulate ram all be able to manipulate RAM so it won't really work

02:20.320 --> 02:27.320
doesn't matter what I put in here to say this is where the next instruction is but at the the Yvi

02:27.320 --> 02:33.880
and correct destruction is zero one zero one zero one zero one and then the last four are

02:37.240 --> 02:48.760
the flags okay for c out a larger equals in z so i have equals and z here selected all right

02:48.760 --> 02:55.160
and so when we look at our control unit and we view our control unit we have coming out of

02:57.320 --> 03:02.760
one zero one zero is this one coming out we have four coming out of one two three four six

03:03.480 --> 03:07.720
we have three steps four five and six on step four

03:10.520 --> 03:14.440
okay we're going to look at pc out pc enable

03:16.520 --> 03:22.760
and accumulator set and memory address set so the first thing it's going to do is going to take

03:22.760 --> 03:27.160
whatever's in the program counter and put it on the bus and then it's going to stick that into

03:27.160 --> 03:27.320
the program counter and put it on the bus and then it's going to stick that into the

03:27.640 --> 03:30.680
and then it's going to set the accumulator which should be one more than that because

03:31.720 --> 03:35.560
when you have bus one high here it'll be whatever on the

03:36.840 --> 03:41.480
in the counter plus one meaning every time we add just once we move just one

03:42.920 --> 03:46.840
okay and then we're going to stick that new value into the accumulator which would be

03:46.840 --> 03:51.160
one more than the old value and we're also going to set that as the memory address

03:52.760 --> 03:57.160
okay step five will be take whatever's in the accumulator

03:57.400 --> 04:03.880
and put it on the bus and put it into our program counter as the next instruction

04:04.760 --> 04:10.360
okay so down here on our program counter now we have two possible results and we're going to or

04:10.360 --> 04:17.240
them and we'll show you what that means in a minute so the step six will be we've added step

04:17.240 --> 04:26.600
six step six is what's gonna happen you see this green line on the bottom is this check of c a e and

04:26.600 --> 04:36.040
z they're coming in and i'm comparing them to c a e and z so right now the alu is saying equals and

04:36.040 --> 04:41.720
zeros are both high and i'm checking for equals and zeros so they're both high which comes in this

04:41.720 --> 04:47.800
or and says this is high which says oh when i get to this step i'm gonna take whatever's on ram and

04:47.800 --> 04:55.080
put on the bus okay and then that's gonna go into the program counter so what i will do is

04:55.080 --> 05:03.240
what's in the program counter right now is one more than the current location in ram okay for my

05:03.240 --> 05:07.640
program counter and what i'm gonna do is i'm gonna replace it with whatever stored in ram to say hey

05:07.640 --> 05:13.080
no i don't want to do the next place i want to jump somewhere else okay so i jump if any of these

05:13.080 --> 05:19.240
things are true so they match one and one zero zeros are not matches just ones and ones

05:21.960 --> 05:24.840
all right so if we go back to our cpu jump if

05:25.480 --> 05:29.240
and we start cycling through because i got to get to four

05:33.000 --> 05:39.080
okay so here's four okay i'm in enable bus one's enabled

05:41.160 --> 05:48.280
and because pc program counter is enabled and then i'm gonna set into memory address

05:48.280 --> 05:54.920
and the accumulator okay so bus one is also enabled so when i go back to

05:55.080 --> 06:02.360
my jump if cpu i have one here and a is zero so the alu is going to add them and put one

06:02.920 --> 06:07.960
when i set the accumulator one will be here but when i set the memory address it'll be

06:07.960 --> 06:16.040
off the bus so it'll be zero okay so zero is our current program counter our current instruction

06:16.840 --> 06:22.440
one will be our next instruction okay so i cycle set

06:25.320 --> 06:26.760
okay and then step five

06:29.000 --> 06:33.480
step five is where i take what's in the accumulator and stick it on the bus

06:33.480 --> 06:35.480
and then stick it into the program counter

06:42.120 --> 06:50.440
okay so here i'm enabled the accumulator is one it's on the bus because i set this to always be

06:51.080 --> 06:55.000
on i've already set it because i actually didn't set it as

06:55.000 --> 06:58.920
well okay so one's in the program counter for the next one

07:01.800 --> 07:11.720
cycle and now when i go to six here enable is fine but i don't really have anything in ram

07:13.320 --> 07:19.880
so i won't be able to overwrite it but here i have equals and zero are both high still

07:20.600 --> 07:24.520
so that means they're a match which means i'm going to take whatever's in ram

07:25.480 --> 07:29.720
when i enable it i'm going to take whatever's in ram and i'm going to set it in the program

07:29.720 --> 07:37.720
counter okay and so that should not work because when i go to the next step i should get all red

07:37.720 --> 07:41.880
because there's all ease and ram so i'm not getting something into ram

07:42.840 --> 07:47.640
but if i had something in there it would put out on the bus and then it would go into the

07:47.640 --> 07:54.040
program counter okay and so that's how i jump if certain conditions are true and how i check them

07:55.960 --> 08:02.840
all right so that's a jump if um it's not fully complete but it should show you how you can jump

08:02.840 --> 08:09.480
around to different locations in ram to grab instructions based on certain conditions

08:10.840 --> 08:15.480
so that you can have your code do more than just a linear thing`;

        // 2. CORE UTILITIES
        function timeToSeconds(timeStr) {
            if (!timeStr) return 0;
            const parts = timeStr.trim().split(':');
            
            // Handle both MM:SS.mmm and HH:MM:SS.mmm formats
            if (parts.length === 2) {
                // MM:SS.mmm format
                let minutes = parseInt(parts[0]) || 0;
                let seconds = parseFloat(parts[1]) || 0;
                return minutes * 60 + seconds;
            } else if (parts.length === 3) {
                // HH:MM:SS.mmm format
                let hours = parseInt(parts[0]) || 0;
                let minutes = parseInt(parts[1]) || 0;
                let seconds = parseFloat(parts[2]) || 0;
                return hours * 3600 + minutes * 60 + seconds;
            }
            return 0;
        }

        function parseVtt(vttText) {
            const cues = vttText.trim().split(/\n\n+/);
            const parsedCues = [];
            
            cues.forEach(cueBlock => {
                if (cueBlock.startsWith('WEBVTT') || cueBlock.trim() === '') return;
                
                const lines = cueBlock.trim().split('\n');
                const timeLine = lines.find(line => line.includes('-->'));
                if (!timeLine) return;

                const [startTimeStr, endTimeStr] = timeLine.split(' --> ');
                const textLines = lines.slice(lines.indexOf(timeLine) + 1);
                
                parsedCues.push({
                    start: timeToSeconds(startTimeStr),
                    end: timeToSeconds(endTimeStr),
                    text: textLines.join(' ').trim()
                });
            });
            return parsedCues;
        }

        // 3. TRANSCRIPT RENDERING AND INTERACTIVITY
        function populateTranscript() {
            const container = document.getElementById('transcript-container');
            if (!container) return;
            container.innerHTML = '';

            parsedTranscript.forEach(cue => {
                const lineElement = document.createElement('div');
                lineElement.className = 'transcript-line p-2 cursor-pointer hover:bg-gray-100 rounded-lg';
                lineElement.dataset.start = cue.start;
                lineElement.dataset.end = cue.end;
                lineElement.textContent = cue.text;
                lineElement.setAttribute('role', 'button');
                lineElement.setAttribute('tabindex', '0');

                const seekToTime = () => {
                    if (player && player.seekTo) {
                        player.seekTo(cue.start, true);
                        player.playVideo();
                    }
                };
                
                lineElement.addEventListener('click', seekToTime);
                lineElement.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' || e.key === ' ') { 
                        e.preventDefault(); 
                        seekToTime(); 
                    }
                });

                container.appendChild(lineElement);
            });
        }

        // 4. SYNC LOGIC
        function highlightCurrentLine() {
            if (!player || !player.getCurrentTime) return;

            const currentTime = player.getCurrentTime();
            const lines = document.querySelectorAll('#transcript-container .transcript-line');

            lines.forEach(line => {
                const start = parseFloat(line.dataset.start);
                const end = parseFloat(line.dataset.end);

                if (currentTime >= start && currentTime < end) {
                    if (!line.classList.contains('active-transcript-line')) {
                        document.querySelector('.active-transcript-line')?.classList.remove('active-transcript-line');
                        line.classList.add('active-transcript-line');
                        line.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                } else {
                    line.classList.remove('active-transcript-line');
                }
            });
        }

        // 5. HEIGHT SYNCHRONIZATION (Transcript matches video container)
        function syncTranscriptHeight() {
            const mediaQuery = window.matchMedia('(min-width: 1024px)');
            const videoContainer = document.getElementById('video-container');
            const transcriptContainer = document.getElementById('transcript-container');
            
            if (!videoContainer || !transcriptContainer) return;
            
            if (mediaQuery.matches) {
                // On large screens, match the video container height
                const videoHeight = videoContainer.offsetHeight;
                transcriptContainer.style.maxHeight = videoHeight + 'px';
            } else {
                // On mobile, use fixed height
                transcriptContainer.style.maxHeight = '24rem';
            }
        }

        // 6. PLAYER STATE HANDLER
        function onPlayerStateChange(event) {
            clearInterval(timeUpdater);
            if (event.data === YT.PlayerState.PLAYING) {
                timeUpdater = setInterval(highlightCurrentLine, 300);
            }
        }

        // 7. INITIALIZATION
        function initializeVideoTranscript() {
            if (videoInitialized) return;
            videoInitialized = true;

            parsedTranscript = parseVtt(vttContent);
            populateTranscript();
            syncTranscriptHeight();

            if (!player) {
                player = new YT.Player('youtube-player', {
                    events: {
                        'onStateChange': onPlayerStateChange
                    }
                });
            }
        }

        // 8. CENTRAL INITIALIZATION
        document.addEventListener('DOMContentLoaded', () => {
            if (typeof(YT) == 'undefined' || typeof(YT.Player) == 'undefined') {
                const tag = document.createElement('script');
                tag.src = "https://www.youtube.com/iframe_api";
                document.head.appendChild(tag);
                window.onYouTubeIframeAPIReady = initializeVideoTranscript;
            }

            // Handle window resize for transcript height sync
            let resizeTimeout;
            window.addEventListener('resize', () => {
                clearTimeout(resizeTimeout);
                resizeTimeout = setTimeout(syncTranscriptHeight, 250);
            });
        });
    </script>
</body>
</html>
