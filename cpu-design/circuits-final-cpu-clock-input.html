<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clock Input Modification</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwindConfig = {
            theme: {
                extend: {
                    colors: {
                        background: '#FDFBF8',
                        'text-primary': '#1A1A1A',
                        'accent-blue': '#2563EB',
                        'code-gray': '#4B5563'
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif']
                    }
                }
            },
            corePlugins: {
                darkMode: false
            }
        }
    </script>
    <style>
        * { @apply !bg-white dark:!bg-white !text-gray-900 dark:!text-gray-900; }
        html, body { background-color: #FDFBF8; color: #1A1A1A; font-family: 'Inter', sans-serif; }
        .prose { @apply text-gray-900; }
        .prose a { @apply text-blue-600 underline hover:text-blue-700 font-medium; }
        .prose h2, .prose h3, .prose h4 { @apply text-gray-900 font-bold mt-6 mb-3; }
        .prose h2 { @apply text-2xl; }
        .prose h3 { @apply text-xl; }
        
        /* Tab navigation styling */
        [role="tablist"] {
            @apply flex flex-wrap gap-2 border-b-2 border-gray-300 bg-white;
            overflow-x: auto;
            scroll-behavior: smooth;
        }

        /* Individual tab button styling */
        [role="tab"] {
            @apply px-6 py-4 font-semibold text-base transition-all duration-200 whitespace-nowrap;
            @apply border-b-4 border-transparent;
            @apply hover:bg-gray-100 cursor-pointer;
            position: relative;
            flex-shrink: 0;
        }

        /* Active tab styling */
        [role="tab"][aria-selected="true"] {
            @apply text-blue-600 border-b-4 border-blue-600 bg-blue-50;
        }

        /* Inactive tab styling */
        [role="tab"][aria-selected="false"] {
            @apply text-gray-600 border-b-4 border-transparent;
            @apply hover:text-gray-900;
        }

        /* Focus state for accessibility */
        [role="tab"]:focus-visible {
            @apply outline-none ring-2 ring-offset-2 ring-blue-600;
        }
        
        /* Panel styling */
        [role="tabpanel"] {
            @apply hidden p-8 bg-white rounded-b-lg;
            animation: fadeIn 0.3s ease-in-out;
        }

        [role="tabpanel"][aria-hidden="false"] {
            @apply block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(4px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* Skip to Content */
        .skip-link {
            @apply absolute top-0 left-0 px-4 py-2 bg-blue-600 text-white -translate-y-full focus:translate-y-0 z-50 transition-transform font-medium;
        }
        
        /* Responsive tab styling for mobile */
        @media (max-width: 640px) {
            [role="tab"] {
                @apply px-4 py-3 text-sm;
            }
            
            [role="tabpanel"] {
                @apply p-6;
            }
        }
    </style>
</head>
<body class="font-sans" style="background-color: #FDFBF8; color: #1A1A1A;">
    <!-- Skip to Content Link -->
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <!-- Header -->
    <header class="bg-white border-b border-gray-200 py-6 mb-8">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
            <h1 class="text-4xl font-bold text-gray-900 mb-2">Clock Input Modification</h1>
            <p class="text-gray-600">Understanding how to modify the clock circuit for automated program execution</p>
        </div>
    </header>

    <!-- Main Content -->
    <main id="main-content" class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 pb-12">
        
        <!-- Tabbed Interface -->
        <div class="mb-8">
            <div role="tablist" class="flex flex-wrap border-b-2 border-gray-300 bg-white -mx-4 sm:mx-0 px-4" aria-label="Clock Input content sections">
                <button role="tab" aria-selected="true" aria-controls="overview-panel" id="overview-tab" class="focus:outline-none">
                    Overview
                </button>
                <button role="tab" aria-selected="false" aria-controls="logic-panel" id="logic-tab" class="focus:outline-none">
                    Design & Logic
                </button>
                <button role="tab" aria-selected="false" aria-controls="diagrams-panel" id="diagrams-tab" class="focus:outline-none">
                    Diagrams
                </button>
                <button role="tab" aria-selected="false" aria-controls="details-panel" id="details-tab" class="focus:outline-none">
                    Implementation Details
                </button>
            </div>

            <!-- Overview Panel -->
            <section role="tabpanel" id="overview-panel" aria-labelledby="overview-tab" aria-hidden="false">
                <div class="prose">
                    <h2>Purpose of Clock Input Modification</h2>
                    <p>The "Clock" circuit needs to be modified so that we no longer have to manually cycle it. In order to run programs, we are going to invoke the "Ticks Enabled" option to automatically run our Assembly programs in the CPU. This modification enables automated program execution by converting the clock to a single input and adding the "End" bit functionality.</p>
                    <p>The key improvement is that the clock can now be automatically controlled, eliminating the need for manual intervention during program execution. This is essential for testing and verifying that our CPU behaves correctly when executing complete programs.</p>
                </div>
            </section>

            <!-- Design & Logic Panel -->
            <section role="tabpanel" id="logic-panel" aria-labelledby="logic-tab" aria-hidden="true">
                <div class="prose">
                    <h2>How the Modification Works</h2>
                    <h3>The END Bit Logic</h3>
                    <p>In order to achieve automatic clock cycling, we need to change the clock to a single input and also add the "End" bit, which will disable the clock cycling at the end of our assembly program.</p>
                    <p>The implementation uses a NOT gate and an AND gate to manage this behavior:</p>
                    <ul>
                        <li>The "END" tunnel is NOTted (inverted)</li>
                        <li>The result is ANDed with the Clock input</li>
                        <li>When "END" is high (true), the NOT gate outputs low (false)</li>
                        <li>When low is ANDed with the Clock input, the output from the AND gate is always low</li>
                        <li>Result: The clock never cycles once END is high, cleanly halting program execution</li>
                    </ul>
                    <p>This elegant design ensures that when a program completes and the END signal is asserted, the clock automatically stops, preventing any further instruction execution.</p>
                </div>
            </section>

            <!-- Diagrams Panel -->
            <section role="tabpanel" id="diagrams-panel" aria-labelledby="diagrams-tab" aria-hidden="true">
                <div class="prose">
                    <h2>Circuit Diagrams: Before and After</h2>
                    
                    <h3>OLD Clock Configuration</h3>
                    <p>The original clock configuration required manual cycling:</p>
                    <figure class="my-6">
                        <img src="images/clockin-old.png" 
                             alt="OLD clock input configuration showing the previous manual cycling setup" 
                             class="max-w-full h-auto rounded-lg border border-gray-300 shadow-sm mx-auto"
                             style="max-width: 640px;"
                             loading="lazy">
                        <figcaption class="text-sm text-gray-600 text-center mt-2 italic">
                            Figure 1: Original Clock Input Configuration
                        </figcaption>
                    </figure>
                    
                    <h3>NEW Clock Configuration</h3>
                    <p>The updated clock configuration with END bit integration and automated control:</p>
                    <figure class="my-6">
                        <img src="images/clockin-new.png" 
                             alt="NEW clock input configuration showing the modified setup with END bit logic and automatic cycling control" 
                             class="max-w-full h-auto rounded-lg border border-gray-300 shadow-sm mx-auto"
                             style="max-width: 640px;"
                             loading="lazy">
                        <figcaption class="text-sm text-gray-600 text-center mt-2 italic">
                            Figure 2: Modified Clock Input Configuration with END Bit Control
                        </figcaption>
                    </figure>
                </div>
            </section>

            <!-- Implementation Details Panel -->
            <section role="tabpanel" id="details-panel" aria-labelledby="details-tab" aria-hidden="true">
                <div class="prose">
                    <h2>Output Pins and Implementation Details</h2>
                    
                    <h3>New Output Pins</h3>
                    <p>Note the addition of output pins for clock-related signals:</p>
                    <ul>
                        <li><strong>clke</strong> – Clock enable signal (output pin)</li>
                        <li><strong>clks</strong> – Clock status signal (output pin)</li>
                    </ul>
                    
                    <h3>Load Clock Signal</h3>
                    <p>There is also an output pin and tunnel added to the "clk" output labeled "clkl", which stands for the Clock signal we need to "Load" our program. This signal is critical for synchronizing program loading with the clock cycle.</p>
                    
                    <h3>Why These Output Pins Matter</h3>
                    <p>The addition of these output pins is necessary in order to be able to view the status of these signals at the next higher level. When working with hierarchical circuit design in Logisim, we need to expose internal signals to parent circuits so that:</p>
                    <ul>
                        <li>We can monitor and verify that the clock modification is functioning correctly</li>
                        <li>Higher-level control circuits can coordinate with the clock signals</li>
                        <li>We can debug timing and synchronization issues during program execution</li>
                        <li>Future modules can access these signals for their own operations</li>
                    </ul>
                </div>
            </section>
        </div>
    </main>

    <!-- Footer -->
    <footer class="border-t border-gray-200 mt-12 py-6 text-center text-sm text-gray-600">
        <div class="max-w-4xl mx-auto px-4">
            <p>Clock Input Modification • CSC210 Computer Organization & Architecture</p>
            <p class="mt-2 text-xs">Last updated: November 2025</p>
        </div>
    </footer>

    <!-- Tab Navigation Script -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const tabs = document.querySelectorAll('[role="tab"]');
            const panels = document.querySelectorAll('[role="tabpanel"]');

            tabs.forEach((tab, index) => {
                tab.addEventListener('click', function() {
                    // Hide all panels
                    panels.forEach(panel => {
                        panel.setAttribute('aria-hidden', 'true');
                    });
                    // Deselect all tabs
                    tabs.forEach(t => {
                        t.setAttribute('aria-selected', 'false');
                    });
                    
                    // Show selected panel
                    const panelId = this.getAttribute('aria-controls');
                    document.getElementById(panelId).setAttribute('aria-hidden', 'false');
                    
                    // Select clicked tab
                    this.setAttribute('aria-selected', 'true');
                });

                // Keyboard navigation: Arrow keys
                tab.addEventListener('keydown', function(e) {
                    let targetIndex = index;
                    
                    if (e.key === 'ArrowLeft') {
                        e.preventDefault();
                        targetIndex = (index - 1 + tabs.length) % tabs.length;
                    } else if (e.key === 'ArrowRight') {
                        e.preventDefault();
                        targetIndex = (index + 1) % tabs.length;
                    }
                    
                    tabs[targetIndex].focus();
                    tabs[targetIndex].click();
                });
            });
        });
    </script>
</body>
</html>
