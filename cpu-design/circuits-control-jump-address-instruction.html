<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Circuits: Jump Address-Only</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
      
      * {
        font-family: 'Inter', sans-serif;
      }
      
      body {
        background-color: #FDFBF8;
        color: #1A1A1A;
      }
      
      .skip-link {
        position: absolute;
        top: -40px;
        left: 0;
        background: #2563EB;
        color: white;
        padding: 0.5rem 1rem;
        text-decoration: none;
        border-radius: 0 0 4px 0;
        z-index: 1000;
      }
      
      .skip-link:focus {
        top: 0;
      }
      
      h1, h2, h3 {
        color: #1A1A1A;
      }
      
      h1 {
        font-size: 2.25rem;
        font-weight: 700;
        line-height: 1.2;
      }
      
      h2 {
        font-size: 1.875rem;
        font-weight: 600;
        line-height: 1.3;
      }
      
      h3 {
        font-size: 1.25rem;
        font-weight: 600;
        line-height: 1.4;
      }
      
      p {
        font-size: 1rem;
        line-height: 1.6;
        color: #1A1A1A;
      }
      
      a {
        color: #2563EB;
        text-decoration: none;
        font-weight: 500;
      }
      
      a:hover {
        text-decoration: underline;
      }
      
      ul {
        list-style-type: disc;
        margin-left: 1.5rem;
      }
      
      li {
        margin-bottom: 0.75rem;
        line-height: 1.6;
      }
      
      figure {
        margin: 1.5rem 0;
      }
      
      figcaption {
        font-size: 0.875rem;
        color: #4B5563;
        font-style: italic;
        margin-top: 0.5rem;
        text-align: center;
      }
      
      img {
        max-width: 100%;
        height: auto;
        border-radius: 0.5rem;
        border: 1px solid #E5E7EB;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        display: block;
        margin: 0 auto;
      }

      /* Table Styling */
      table {
        width: 100%;
        border-collapse: collapse;
        margin: 1.5rem 0;
      }

      th, td {
        border: 1px solid #D1D5DB;
        padding: 0.75rem;
        text-align: center;
      }

      th {
        background-color: #E5E7EB;
        font-weight: 600;
        color: #1A1A1A;
      }

      td {
        background-color: #FFFFFF;
      }

      /* Accessible Tab Styling */
      .tabs-container {
        margin-bottom: 2rem;
      }

      [role="tablist"] {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
        border-bottom: 2px solid #D1D5DB;
        list-style: none;
        margin: 0;
        padding: 0;
      }

      [role="tab"] {
        padding: 0.75rem 1.25rem;
        background-color: #F3F4F6;
        border: 1px solid #D1D5DB;
        border-bottom: none;
        border-radius: 0.5rem 0.5rem 0 0;
        cursor: pointer;
        font-weight: 500;
        color: #1A1A1A;
        transition: all 0.2s ease;
        margin-bottom: -2px;
      }

      [role="tab"]:hover {
        background-color: #E5E7EB;
      }

      [role="tab"][aria-selected="true"] {
        background-color: #2563EB;
        color: #FFFFFF;
        border-color: #2563EB;
        border-bottom-color: #FDFBF8;
      }

      [role="tab"]:focus-visible {
        outline: 2px solid #2563EB;
        outline-offset: 2px;
      }

      [role="tabpanel"] {
        display: none;
        padding: 2rem 0;
        animation: fadeIn 0.2s ease;
      }

      [role="tabpanel"][data-active="true"] {
        display: block;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      [role="tabpanel"] h2 {
        margin-top: 0;
      }
    </style>
  </head>
  <body>
    <!-- Skip Link for Accessibility -->
    <a href="#main-content" class="skip-link">Skip to main content</a>
    
    <main id="main-content" class="container mx-auto px-4 py-12 max-w-4xl">
      <!-- Page Header -->
      <header class="mb-10">
        <h1 class="text-4xl font-bold mb-4">Circuits: Jump Address-Only</h1>
        <p class="text-lg text-gray-700">Before we begin, we first have to define how our Instruction Register works for Jump Address Instructions.</p>
      </header>

      <!-- Accessible Tab Interface -->
      <div class="tabs-container">
        <div role="tablist" aria-label="Content sections">
          <button role="tab" 
                  id="tab-instructions" 
                  aria-selected="true" 
                  aria-controls="panel-instructions">
            Jump Address Instructions
          </button>
          <button role="tab" 
                  id="tab-control-unit" 
                  aria-selected="false" 
                  aria-controls="panel-control-unit">
            Jump Address Control Unit Diagram
          </button>
          <button role="tab" 
                  id="tab-cpu-diagram" 
                  aria-selected="false" 
                  aria-controls="panel-cpu-diagram">
            Jump Address CPU Diagram
          </button>
          <button role="tab" 
                  id="tab-video" 
                  aria-selected="false" 
                  aria-controls="panel-video">
            Jump Address Video
          </button>
        </div>

        <!-- Section 1: Jump Address Instructions -->
        <section role="tabpanel" 
                 id="panel-instructions" 
                 aria-labelledby="tab-instructions"
                 data-active="true">
          <h2 class="text-3xl font-semibold mb-6">Jump Address Instructions</h2>
        
          <p class="mb-6">The Operation instruction is an 8-bit value that is broken down as follows:</p>
          
          <div class="overflow-x-auto mb-6">
            <table>
              <thead>
                <tr>
                  <th style="width: 12.5%;">bit 0</th>
                  <th style="width: 12.5%;">bit 1</th>
                  <th style="width: 12.5%;">bit 2</th>
                  <th style="width: 12.5%;">bit 3</th>
                  <th style="width: 12.5%;">bit 4</th>
                  <th style="width: 12.5%;">bit 5</th>
                  <th style="width: 12.5%;">bit 6</th>
                  <th style="width: 12.5%;">bit 7</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>0 for Non-ALU Instr.</td>
                  <td>1</td>
                  <td>0</td>
                  <td>0</td>
                  <td>x</td>
                  <td>x</td>
                  <td>x</td>
                  <td>x</td>
                </tr>
              </tbody>
            </table>
          </div>

          <p class="mb-6"><strong>Where:</strong></p>
          <ul class="mb-6 space-y-2">
            <li><strong>bit 0:</strong> When this is 0, then we have either a Load or a Store Instruction</li>
            <li><strong>bits 1-3:</strong> are 100 for a jump address instruction</li>
            <li><strong>bits 4-5:</strong> not used by this operation</li>
            <li><strong>bits 6-7:</strong> not used by this operation</li>
          </ul>

          <h3 class="text-xl font-semibold mb-4">Jump Address Instructions:</h3>
          
          <p class="mb-4">What a Jump Address Instruction does is "jumps" to the next byte in RAM which allows us to pull the address from a byte in RAM as the new address stored in the PC. An assembly language mnemonic might be:</p>
          
          <p class="mb-4 bg-gray-100 p-4 rounded-lg border-l-4 border-blue-500"><code class="text-code-gray">JMP ADDR</code></p>
        </section>

        <!-- Section 2: Jump Address Control Unit Diagram -->
        <section role="tabpanel" 
                 id="panel-control-unit" 
                 aria-labelledby="tab-control-unit"
                 data-active="false">
          <h2 class="text-3xl font-semibold mb-6">Jump Address Instruction Control Unit Diagram</h2>
          
          <p class="mb-6">The actual Control unit for this system appears below. Please note that the following elements have been added and/or removed from this control unit that was not in the previous ones:</p>
          
          <ul class="mb-8 space-y-2">
            <li>Since the Data Instruction is 100 (or 4), we are only wiring up the output for this from the 3x8 decoder</li>
          </ul>

          <figure class="my-6">
            <img id="381108" 
                 src="images/control-unit-diagram-jump-address.jpg" 
                 alt="Control Unit Diagram for Jump Address Instruction showing decoder output wiring for instruction 100" 
                 class="max-w-full h-auto rounded-lg border border-gray-300 shadow-sm mx-auto"
                 style="max-width: 640px;"
                 loading="lazy">
            <figcaption>Jump Address Instruction Control Unit Diagram</figcaption>
          </figure>
        </section>

        <!-- Section 3: Jump Address CPU Diagram -->
        <section role="tabpanel" 
                 id="panel-cpu-diagram" 
                 aria-labelledby="tab-cpu-diagram"
                 data-active="false">
          <h2 class="text-3xl font-semibold mb-6">CPU for Jump Address Instruction</h2>
          
          <p class="mb-6">The temporary modifications included here include:</p>
          
          <ul class="mb-8 space-y-2">
            <li>Removing IR from the BUS so can manually set the value (IR_S is 1)</li>
            <li>Set both PC and RAM to a constant 1 for the "Set" for each</li>
            <li>Removing RAM Input from the BUS so we can set it manually</li>
          </ul>

          <figure class="my-6">
            <img id="381107" 
                 src="images/cpu-diagram-jump-address.jpg" 
                 alt="CPU Circuit Layout for Jump Address Instruction showing IR bus, PC, and RAM modifications" 
                 class="max-w-full h-auto rounded-lg border border-gray-300 shadow-sm mx-auto"
                 style="max-width: 640px;"
                 loading="lazy">
            <figcaption>Jump Address CPU Circuit Diagram</figcaption>
          </figure>
        </section>

        <!-- Section 4: Video Description of Operation -->
        <section role="tabpanel" 
                 id="panel-video" 
                 aria-labelledby="tab-video"
                 data-active="false">
          <h2 class="text-3xl font-semibold mb-6">Video Description of Operation</h2>
          
          <p class="mb-6">The following video walks through the details of the Jump Address Instruction Operation. Use the transcript panel to navigate the video or click any transcript line to jump to that moment.</p>
          
          <!-- Video and Transcript Container -->
          <div class="flex flex-col lg:flex-row gap-4 w-full my-6">
            <!-- Video Player Section: 66% width on large screens -->
            <div class="w-full lg:w-2/3 flex-shrink-0">
              <div id="video-container" style="width: 100%; height: 0; padding-bottom: 56.25%; position: relative;">
                <iframe id="youtube-player"
                        style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;"
                        src="https://www.youtube.com/embed/oQbk8rDnxVI?enablejsapi=1"
                        title="Jump Address Instruction: Detailed Walkthrough of Address Loading and PC Operations"
                        frameborder="0"
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                        referrerpolicy="strict-origin-when-cross-origin"
                        allowfullscreen>
                </iframe>
              </div>
            </div>

            <!-- Transcript Container Section: 33% width on large screens -->
            <div class="w-full lg:w-1/3 flex-shrink-0">
              <div id="transcript-container" class="h-96 overflow-y-scroll bg-white shadow-inner p-4 rounded-lg border border-gray-300">
                <p class="text-gray-500 text-center">Loading transcript...</p>
              </div>
            </div>
          </div>

          <!-- CSS for highlighting the active line -->
          <style>
            .active-transcript-line {
              background-color: #f0f7ff;
              font-weight: 600;
              border-left: 4px solid #1e88e5;
              padding-left: 12px;
              transition: background-color 0.2s;
            }
          </style>
        </section>
      </div>

    </main>

    <!-- Footer -->
    <footer class="bg-gray-100 border-t border-gray-300 mt-12 py-6">
      <div class="container mx-auto px-4 max-w-4xl text-center text-sm text-gray-600">
        <p>CSC210: Computer Organization & Architecture</p>
      </div>
    </footer>

    <!-- Tab Functionality and YouTube Transcript Sync Script -->
    <script>
      // ============== TAB SWITCHING LOGIC ==============
      document.addEventListener('DOMContentLoaded', function() {
        const tabs = document.querySelectorAll('[role="tab"]');
        const panels = document.querySelectorAll('[role="tabpanel"]');

        // Click handler for tabs
        tabs.forEach(tab => {
          tab.addEventListener('click', function() {
            const tabId = this.id;
            const panelId = this.getAttribute('aria-controls');

            // Hide all panels
            panels.forEach(panel => {
              panel.setAttribute('data-active', 'false');
            });

            // Deselect all tabs
            tabs.forEach(t => {
              t.setAttribute('aria-selected', 'false');
            });

            // Show selected panel
            const selectedPanel = document.getElementById(panelId);
            if (selectedPanel) {
              selectedPanel.setAttribute('data-active', 'true');
            }

            // Select clicked tab
            this.setAttribute('aria-selected', 'true');
            this.focus();

            // Initialize transcript when video tab is opened
            if (panelId === 'panel-video') {
              initializeVideoTranscript();
            }
          });
        });

        // Keyboard navigation (Arrow keys)
        tabs.forEach((tab, index) => {
          tab.addEventListener('keydown', function(e) {
            let targetTab = null;

            switch(e.key) {
              case 'ArrowLeft':
              case 'ArrowUp':
                e.preventDefault();
                // Go to previous tab
                targetTab = index > 0 ? tabs[index - 1] : tabs[tabs.length - 1];
                break;
              case 'ArrowRight':
              case 'ArrowDown':
                e.preventDefault();
                // Go to next tab
                targetTab = index < tabs.length - 1 ? tabs[index + 1] : tabs[0];
                break;
              case 'Home':
                e.preventDefault();
                targetTab = tabs[0];
                break;
              case 'End':
                e.preventDefault();
                targetTab = tabs[tabs.length - 1];
                break;
            }

            if (targetTab) {
              targetTab.click();
            }
          });
        });
      });

      // ============== YOUTUBE TRANSCRIPT SYNC LOGIC ==============
      const VIDEO_ID = 'oQbk8rDnxVI';
      let player;
      let timeUpdater;
      let parsedTranscript = [];
      let videoInitialized = false;

      // --- RAW VTT CONTENT ---
      const vttContent = `WEBVTT

00:00.000 --> 00:12.660
Aloha in this video I want to talk about the jump address instruction the jump address instruction

00:12.660 --> 00:20.120
is very similar to the jump register instruction except for instead of getting the address from

00:20.120 --> 00:31.160
the register we're gonna get the address from RAM all right so how this works is what we're

00:31.160 --> 00:38.420
gonna do is look at the jump address instruction is zero one zero zero zero zero zero zero zero

00:38.420 --> 00:47.540
because they're not used and so it jumps to the next byte in RAM okay so if I have the

00:47.540 --> 00:50.000
address

00:50.120 --> 00:57.000
of my next instruction in RAM it'll jump to that for the next instruction if that makes

00:57.000 --> 01:02.000
sense all right so what we're gonna do is we're gonna do our simulation we're gonna set our

01:02.000 --> 01:08.060
instruction register to zero one zero zero zero zero and then we're gonna say that so we'll start

01:08.060 --> 01:14.660
obviously the first one's gonna be in program code zero because we're already working on one

01:14.660 --> 01:19.680
okay and then what we're gonna do in zero is we're gonna stick this value of seven

01:20.120 --> 01:24.520
okay and so what we're gonna do is we're gonna grab that seven and stick it back into the program

01:24.520 --> 01:30.560
counter to say the next instructions at location seven okay so if we look at our control unit again

01:30.560 --> 01:34.700
we're not starting until step four one two and three or fetch which we're skipping right now

01:34.700 --> 01:43.820
we're just assuming that we already are doing something all right so let's look at our CPU and

01:43.820 --> 01:45.740
we'll get all the way

01:50.120 --> 01:58.580
over to step four step four comes in and it's going to enable the program counter which means

01:58.580 --> 02:02.600
it's going to take whatever's in there and put it on the bus which is where we're at right now we're

02:02.600 --> 02:10.520
enabling it and then it's going to take the set part is going to take that and stick it in to our

02:10.520 --> 02:17.120
memory address register so where in what memory are we looking for in RAM okay so initially we're

02:17.120 --> 02:19.460
starting at zero so it's going to look at all zeros

02:20.120 --> 02:30.020
what's stored in there right now because we hard-coded it is if we look at our RAM in byte zero

02:30.020 --> 02:39.500
because we hard-coded it is as soon as we set it sorry as soon as we haven't set the register for

02:39.500 --> 02:44.420
the memory address register yet we have it as all zeros but we haven't set it yet as soon as we set

02:44.420 --> 02:48.560
it it'll stick it in to byte zero

02:50.120 --> 02:57.260
okay so the second one more to set look at our control system now we're setting we're setting

02:57.260 --> 03:07.940
our memory address register um and if I look at this now we'll see that by zero now has

03:09.140 --> 03:15.920
the zero zero zero zero zero one one one in it okay

03:18.920 --> 03:19.940
so we have that

03:20.120 --> 03:22.160
we know what where memory is

03:24.980 --> 03:28.100
now we enable what we're doing is we're grabbing from memory

03:28.880 --> 03:33.860
because that's what this one does it grabs from RAM and enables RAM so it's grabbing that same

03:33.860 --> 03:38.540
address that we previously specified in RAM and it's going to stick it into the program counter

03:40.700 --> 03:43.700
okay so we'll cycle again to set

03:46.160 --> 03:49.760
here's the program counter set so here we go one one one

03:50.120 --> 03:52.340
so that's our next

03:54.500 --> 04:02.480
instruction is stored would be stored in byte seven right here we don't have anything in here

04:02.480 --> 04:08.480
but that's where we're saying it would be stored okay if we could load all our RAM with all our

04:08.480 --> 04:12.260
instructions then it would make sense okay

04:14.960 --> 04:18.980
that's our simulation

04:20.120 --> 04:21.800
for jump address

04:24.200 --> 04:28.640
okay so it's just like jump register except for instead of sticking the address in a register

04:29.360 --> 04:33.980
and pulling it from there we're sticking it into RAM directly and pulling it from

04:33.980 --> 04:34.220
right

04:34.220 --> 04:35.060
you`;

      // 2. CORE UTILITIES
      function timeToSeconds(timeStr) {
        if (!timeStr) return 0;
        const parts = timeStr.trim().split(':');
        
        // Handle both MM:SS.mmm and HH:MM:SS.mmm formats
        if (parts.length === 2) {
          // MM:SS.mmm format
          let minutes = parseInt(parts[0]) || 0;
          let seconds = parseFloat(parts[1]) || 0;
          return minutes * 60 + seconds;
        } else if (parts.length === 3) {
          // HH:MM:SS.mmm format
          let hours = parseInt(parts[0]) || 0;
          let minutes = parseInt(parts[1]) || 0;
          let seconds = parseFloat(parts[2]) || 0;
          return hours * 3600 + minutes * 60 + seconds;
        }
        return 0;
      }

      function parseVtt(vttText) {
        const cues = vttText.trim().split(/\n\n+/);
        const parsedCues = [];
        
        cues.forEach(cueBlock => {
          if (cueBlock.startsWith('WEBVTT') || cueBlock.trim() === '') return;
          
          const lines = cueBlock.trim().split('\n');
          const timeLine = lines.find(line => line.includes('-->'));
          if (!timeLine) return;

          const [startTimeStr, endTimeStr] = timeLine.split(' --> ');
          const textLines = lines.slice(lines.indexOf(timeLine) + 1);
          
          parsedCues.push({
            start: timeToSeconds(startTimeStr),
            end: timeToSeconds(endTimeStr),
            text: textLines.join(' ').trim()
          });
        });
        return parsedCues;
      }

      // 3. TRANSCRIPT RENDERING AND INTERACTIVITY
      function populateTranscript() {
        const container = document.getElementById('transcript-container');
        if (!container) return;
        container.innerHTML = '';

        parsedTranscript.forEach(cue => {
          const lineElement = document.createElement('div');
          lineElement.className = 'transcript-line p-2 cursor-pointer hover:bg-gray-100 rounded-lg';
          lineElement.dataset.start = cue.start;
          lineElement.dataset.end = cue.end;
          lineElement.textContent = cue.text;
          lineElement.setAttribute('role', 'button');
          lineElement.setAttribute('tabindex', '0');

          const seekToTime = () => {
            if (player && player.seekTo) {
              player.seekTo(cue.start, true);
              player.playVideo();
            }
          };
          
          lineElement.addEventListener('click', seekToTime);
          lineElement.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' || e.key === ' ') { 
              e.preventDefault(); 
              seekToTime(); 
            }
          });

          container.appendChild(lineElement);
        });
      }

      // 4. SYNC LOGIC
      function highlightCurrentLine() {
        if (!player || !player.getCurrentTime) return;

        const currentTime = player.getCurrentTime();
        const lines = document.querySelectorAll('#transcript-container .transcript-line');

        lines.forEach(line => {
          const start = parseFloat(line.dataset.start);
          const end = parseFloat(line.dataset.end);

          if (currentTime >= start && currentTime < end) {
            if (!line.classList.contains('active-transcript-line')) {
              document.querySelector('.active-transcript-line')?.classList.remove('active-transcript-line');
              line.classList.add('active-transcript-line');
              line.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
          } else {
            line.classList.remove('active-transcript-line');
          }
        });
      }

      // 5. HEIGHT SYNCHRONIZATION (Transcript matches video container)
      function syncTranscriptHeight() {
        const mediaQuery = window.matchMedia('(min-width: 1024px)');
        const videoContainer = document.getElementById('video-container');
        const transcriptContainer = document.getElementById('transcript-container');
        
        if (!videoContainer || !transcriptContainer) return;
        
        if (mediaQuery.matches) {
          // On large screens, match the video container height
          const videoHeight = videoContainer.offsetHeight;
          transcriptContainer.style.maxHeight = videoHeight + 'px';
        } else {
          // On mobile, use fixed height
          transcriptContainer.style.maxHeight = '24rem';
        }
      }

      // 6. PLAYER STATE HANDLER
      function onPlayerStateChange(event) {
        clearInterval(timeUpdater);
        if (event.data === YT.PlayerState.PLAYING) {
          timeUpdater = setInterval(highlightCurrentLine, 300);
        }
      }

      // 7. INITIALIZATION
      function initializeVideoTranscript() {
        if (videoInitialized) return;
        videoInitialized = true;

        parsedTranscript = parseVtt(vttContent);
        populateTranscript();
        syncTranscriptHeight();

        if (!player) {
          player = new YT.Player('youtube-player', {
            events: {
              'onStateChange': onPlayerStateChange
            }
          });
        }
      }

      // 8. CENTRAL INITIALIZATION
      document.addEventListener('DOMContentLoaded', () => {
        if (typeof(YT) == 'undefined' || typeof(YT.Player) == 'undefined') {
          const tag = document.createElement('script');
          tag.src = "https://www.youtube.com/iframe_api";
          document.head.appendChild(tag);
          window.onYouTubeIframeAPIReady = initializeVideoTranscript;
        }

        // Handle window resize for transcript height sync
        let resizeTimeout;
        window.addEventListener('resize', () => {
          clearTimeout(resizeTimeout);
          resizeTimeout = setTimeout(syncTranscriptHeight, 250);
        });
      });
    </script>
  </body>
</html>
