<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Week 3 Enhanced Learning: Combinational Logic</title>
    <style>
        /* CSS Reset and Basic Setup */
        :root {
            --primary-bg: #ffffff;
            --text-color: #212529;
            --primary-color: #005a9c;
            --secondary-color: #f0f3f5;
            --border-color: #ced4da;
            --success-color: #28a745;
            --context-bg: #e7f5ff;
            --wire-inactive-color: #adb5bd;
            --wire-active-color: #ffc107;
            --gate-bg: #fff;
        }

        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.6;
            background-color: var(--primary-bg);
            color: var(--text-color);
        }
        
        /* ADA Compliance: Focus visibility */
        :focus-visible { outline: 3px solid var(--primary-color); outline-offset: 2px; }

        /* --- Layout and Structure --- */
        .container { max-width: 960px; margin: 0 auto; padding: 20px; }
        header, footer { background-color: var(--primary-color); color: white; text-align: center; padding: 1rem; }
        nav { background-color: var(--secondary-color); padding: 0.5rem; border-bottom: 2px solid var(--border-color); position: sticky; top: 0; z-index: 1000; }
        nav ul { list-style: none; padding: 0; margin: 0; display: flex; justify-content: center; flex-wrap: wrap; gap: 20px; }
        nav a { color: var(--primary-color); text-decoration: none; font-weight: bold; padding: 5px 10px; border-radius: 5px; }
        nav a:hover, nav a:focus { background-color: var(--primary-color); color: white; }
        section { padding: 40px 10px; border-bottom: 1px solid var(--border-color); }
        h1, h2, h3 { color: var(--primary-color); }
        h2 { border-bottom: 2px solid #e9ecef; padding-bottom: 10px; margin-bottom: 20px; }

        /* --- Interactive Components --- */
        .interactive-area {
            display: grid;
            grid-template-columns: 200px 1fr;
            gap: 20px;
            margin-top: 20px;
        }
        .controls { display: flex; flex-direction: column; gap: 15px; }
        .control-group { display: flex; align-items: center; gap: 10px; }
        .control-group label { font-weight: bold; min-width: 80px; }
        .toggle-btn { padding: 8px 15px; font-size: 1rem; cursor: pointer; border: 2px solid var(--border-color); border-radius: 5px; background-color: var(--wire-inactive-color); color: white; width: 50px; text-align: center; font-weight: bold; }
        .toggle-btn.active { background-color: var(--wire-active-color); border-color: #e0ac00; color: var(--text-color); }
        
        .simulation-view { border: 1px solid var(--border-color); border-radius: 8px; padding: 20px; min-height: 250px; }
        .functional-view { display: flex; justify-content: space-around; align-items: center; }
        .logic-view { display: none; position: relative; }
        
        .light-indicator { width: 50px; height: 50px; border-radius: 50%; background-color: var(--wire-inactive-color); border: 3px solid #343a40; transition: background-color 0.2s; }
        .light-indicator.on { background-color: var(--wire-active-color); box-shadow: 0 0 15px var(--wire-active-color); }

        .view-toggle { margin-top: 15px; padding: 10px 15px; background-color: var(--primary-color); color: white; border: none; border-radius: 5px; cursor: pointer; }
        
        /* --- System Context Box --- */
        .system-context { background-color: var(--context-bg); border: 1px solid #bde0fe; border-radius: 8px; padding: 20px; margin-top: 30px; }
        .system-context h3 { color: #004085; margin-top: 0; }
        
        /* --- Logic Gate and Wire Styling --- */
        .gate { position: absolute; width: 60px; height: 30px; border: 2px solid #343a40; background-color: var(--gate-bg); border-radius: 5px; text-align: center; line-height: 30px; font-size: 0.8em; font-weight: bold; }
        .gate-xor { border-radius: 5px 20px 20px 5px; }
        .wire { position: absolute; background-color: var(--wire-inactive-color); transition: background-color 0.2s; }
        .wire.active { background-color: var(--wire-active-color); }
        .h-wire { height: 2px; }
        .v-wire { width: 2px; }

        /* Full Adder Logic View Specifics */
        #adder-logic-view .gate { z-index: 2; }
        #adder-logic-view .wire { z-index: 1; }

        /* --- Responsive Design --- */
        @media (max-width: 768px) {
            .interactive-area { grid-template-columns: 1fr; }
            .controls { grid-row: 2; }
        }
    </style>
</head>
<body>

    <header><h1>CSC210: Combinational Logic (Enhanced)</h1></header>
    <nav>
        <ul>
            <li><a href="#adders">Arithmetic Circuits</a></li>
            <li><a href="#multiplexers">Data Selectors</a></li>
            <li><a href="#decoders">Code Converters</a></li>
        </ul>
    </nav>

    <main class="container">
        
        <hr>

        <section id="adders">
            <h2>Arithmetic Circuits: The 1-Bit Full Adder</h2>
            <p>A <strong>full adder</strong> adds three 1-bit binary numbers (A, B, and a Carry-In) and produces a 2-bit result: a Sum and a Carry-Out. Toggle the inputs to see the result. Use the button below the controls to switch between a functional view and the internal gate logic.</p>
            
            <div class="interactive-area">
                <div class="controls">
                    <h3>Inputs</h3>
                    <div class="control-group"><label for="adder-a">Input A:</label><button id="adder-a" class="toggle-btn" data-value="0" role="switch" aria-checked="false">0</button></div>
                    <div class="control-group"><label for="adder-b">Input B:</label><button id="adder-b" class="toggle-btn" data-value="0" role="switch" aria-checked="false">0</button></div>
                    <div class="control-group"><label for="adder-cin">Carry-In:</label><button id="adder-cin" class="toggle-btn" data-value="0" role="switch" aria-checked="false">0</button></div>
                    <button class="view-toggle" data-target="adder">Show Internal Logic</button>
                </div>
                
                <div class="simulation-view">
                    <div id="adder-functional-view" class="functional-view">
                        <div>
                            <h4>Sum</h4>
                            <div id="adder-sum-light" class="light-indicator" role="status" aria-label="Sum Output"></div>
                        </div>
                        <div>
                            <h4>Carry-Out</h4>
                            <div id="adder-cout-light" class="light-indicator" role="status" aria-label="Carry-Out Output"></div>
                        </div>
                    </div>
                    
                    <div id="adder-logic-view" class="logic-view">
                        <div id="aw1" class="wire h-wire" style="left:0; top:25px; width:50px;"></div>
                        <div id="aw2" class="wire h-wire" style="left:0; top:125px; width:50px;"></div>
                        <div id="bw1" class="wire h-wire" style="left:0; top:75px; width:50px;"></div>
                        <div id="bw2" class="wire h-wire" style="left:0; top:175px; width:50px;"></div>
                        <div id="cinw1" class="wire h-wire" style="left:0; top:225px; width:140px;"></div>
                        <div id="xor1w" class="wire h-wire" style="left:110px; top:50px; width:30px;"></div>
                        <div id="xor1w-v" class="wire v-wire" style="left:140px; top:50px; height:125px;"></div>
                        <div id="and1w" class="wire h-wire" style="left:110px; top:150px; width:120px;"></div>
                        <div id="sumw" class="wire h-wire" style="left:200px; top:100px; width:50px;"></div>
                        <div id="and2w" class="wire h-wire" style="left:200px; top:175px; width:30px;"></div>
                        <div id="coutw" class="wire h-wire" style="left:290px; top:162px; width:50px;"></div>
                        
                        <div class="gate gate-xor" style="left:50px; top:35px;">XOR</div>
                        <div class="gate" style="left:50px; top:135px;">AND</div>
                        <div class="gate gate-xor" style="left:140px; top:85px;">XOR</div>
                        <div class="gate" style="left:140px; top:160px;">AND</div>
                        <div class="gate" style="left:230px; top:147px;">OR</div>
                        
                        <span style="position:absolute; left:255px; top:92px;"><b>Sum</b></span>
                        <span style="position:absolute; left:345px; top:154px;"><b>Cout</b></span>
                    </div>
                </div>
            </div>

            <div class="system-context">
                <h3>ðŸ§  System Context: The Heart of the CPU</h3>
                <p>The 1-bit full adder is the fundamental component of a CPU's <strong>Arithmetic Logic Unit (ALU)</strong>. By chaining multiple full adders together (e.g., 64 of them), you create a multi-bit adder capable of performing arithmetic on large binary numbers. This circuit is directly responsible for nearly all addition and subtraction operations your computer performs.</p>
            </div>
        </section>

        <hr>

        <section id="multiplexers">
            <h2>Data Selectors: The 4-to-1 Multiplexer (MUX)</h2>
            <p>A <strong>multiplexer</strong> (MUX) acts as a digital switch, selecting one of several input lines and forwarding it to a single output. A 4-to-1 MUX uses two 'Select Lines' (S1, S0) to choose one of four 'Data Inputs' (D0-D3). </p>
            
            <div class="interactive-area">
                <div class="controls">
                    <h3>Select Lines</h3>
                    <div class="control-group"><label for="mux-s1">S1:</label><button id="mux-s1" class="toggle-btn" data-value="0" role="switch" aria-checked="false">0</button></div>
                    <div class="control-group"><label for="mux-s0">S0:</label><button id="mux-s0" class="toggle-btn" data-value="0" role="switch" aria-checked="false">0</button></div>
                    <hr>
                    <h3>Data Inputs</h3>
                    <div class="control-group"><label for="mux-d0">D0:</label><button id="mux-d0" class="toggle-btn" data-value="0" role="switch" aria-checked="false">0</button></div>
                    <div class="control-group"><label for="mux-d1">D1:</label><button id="mux-d1" class="toggle-btn" data-value="1" role="switch" aria-checked="true" class="active">1</button></div>
                    <div class="control-group"><label for="mux-d2">D2:</label><button id="mux-d2" class="toggle-btn" data-value="0" role="switch" aria-checked="false">0</button></div>
                    <div class="control-group"><label for="mux-d3">D3:</label><button id="mux-d3" class="toggle-btn" data-value="1" role="switch" aria-checked="true" class="active">1</button></div>
                    <button class="view-toggle" data-target="mux">Show Internal Logic</button>
                </div>
                
                 <div class="simulation-view">
                    <div id="mux-functional-view" class="functional-view">
                        <div>
                            <h4>Output Y</h4>
                            <div id="mux-y-light" class="light-indicator" role="status" aria-label="MUX Output Y"></div>
                        </div>
                    </div>
                    <div id="mux-logic-view" class="logic-view" style="font-size: 0.8em; text-align:center;">
                       <p><i>Internal logic visualization for the MUX is a great next step. It typically involves NOT gates for the select lines, four 3-input AND gates, and one 4-input OR gate. This implementation demonstrates the functional behavior.</i></p>
                    </div>
                </div>
            </div>

            <div class="system-context">
                <h3>ðŸš¦ System Context: CPU Data Routing</h3>
                <p>Multiplexers are the "traffic cops" of a CPU. A common use is in the <strong>CPU register file</strong>. If the ALU needs to add the contents of Register X and Register Y, a MUX selects the data from Register X out of all available registers (e.g., 32 or 64) and sends it to the ALU. Another MUX does the same for Register Y. They are critical for routing data between different parts of the processor.</p>
            </div>
        </section>

        <hr>

        <section id="decoders">
            <h2>Code Converters: The 2-to-4 Decoder</h2>
            <p>A <strong>decoder</strong> does the opposite of a multiplexer's select lines: it takes a binary number as input and activates a single corresponding output line. A 2-to-4 decoder takes a 2-bit input (A1, A0) and asserts exactly one of its four output lines (Y0-Y3). This is fundamental for selecting specific locations or devices.</p>
            <div class="interactive-area">
                <div class="controls">
                    <h3>Inputs</h3>
                    <div class="control-group"><label for="dec-a1">A1:</label><button id="dec-a1" class="toggle-btn" data-value="0" role="switch" aria-checked="false">0</button></div>
                    <div class="control-group"><label for="dec-a0">A0:</label><button id="dec-a0" class="toggle-btn" data-value="0" role="switch" aria-checked="false">0</button></div>
                    <button class="view-toggle" data-target="dec">Show Internal Logic</button>
                </div>

                <div class="simulation-view">
                    <div id="dec-functional-view" class="functional-view" style="flex-direction:column; gap: 10px;">
                        <div style="display:flex; gap: 20px;">
                            <div class="text-center"><h4>Y0</h4><div id="dec-y0-light" class="light-indicator on"></div></div>
                            <div class="text-center"><h4>Y1</h4><div id="dec-y1-light" class="light-indicator"></div></div>
                            <div class="text-center"><h4>Y2</h4><div id="dec-y2-light" class="light-indicator"></div></div>
                            <div class="text-center"><h4>Y3</h4><div id="dec-y3-light" class="light-indicator"></div></div>
                        </div>
                    </div>
                    <div id="dec-logic-view" class="logic-view" style="font-size: 0.8em; text-align:center;">
                        <p><i>A 2-to-4 decoder is built with two NOT gates (to create A1', A0') and four 2-input AND gates. Each AND gate corresponds to one output and is connected to a unique combination of the true or inverted inputs (e.g., Y0 = A1' AND A0').</i></p>
                    </div>
                </div>
            </div>

            <div class="system-context">
                <h3>ðŸ’¾ System Context: Memory Address Decoding</h3>
                <p>Decoders are essential for accessing computer memory (RAM). When your CPU needs to read data from a specific memory address, it sends that address in binary to a decoder. The decoder activates a single "word line" corresponding to that address, which tells the correct row of memory cells to output their data onto the data bus. Without decoders, the CPU wouldn't be able to select a unique memory location.</p>
            </div>
        </section>

    </main>

    <footer><p>Enhanced Interactive Artifact for CSC210L</p></footer>

<script>
document.addEventListener('DOMContentLoaded', () => {

    // --- Universal Toggle Button Logic ---
    const allToggleButtons = document.querySelectorAll('.toggle-btn');
    allToggleButtons.forEach(button => {
        button.addEventListener('click', () => {
            const currentValue = parseInt(button.dataset.value);
            const newValue = 1 - currentValue;
            button.dataset.value = newValue;
            button.textContent = newValue;
            button.classList.toggle('active');
            button.setAttribute('aria-checked', newValue === 1);
            document.dispatchEvent(new Event('updateSimulators'));
        });
        // Initial setup for active buttons
        if (button.dataset.value === '1') button.classList.add('active');
    });

    // --- View Toggler Logic ---
    document.querySelectorAll('.view-toggle').forEach(button => {
        button.addEventListener('click', (e) => {
            const target = e.target.dataset.target;
            const funcView = document.getElementById(`${target}-functional-view`);
            const logicView = document.getElementById(`${target}-logic-view`);
            
            if (logicView.style.display === 'none' || logicView.style.display === '') {
                funcView.style.display = 'none';
                logicView.style.display = 'block';
                e.target.textContent = 'Show Functional View';
            } else {
                funcView.style.display = 'flex';
                logicView.style.display = 'none';
                e.target.textContent = 'Show Internal Logic';
            }
        });
    });
    
    // --- Full Adder Simulation ---
    function updateFullAdder() {
        const a = parseInt(document.getElementById('adder-a').dataset.value);
        const b = parseInt(document.getElementById('adder-b').dataset.value);
        const cin = parseInt(document.getElementById('adder-cin').dataset.value);

        // Gate-level calculations
        const xor1_out = a ^ b;
        const and1_out = a & b;
        const sum = xor1_out ^ cin;
        const and2_out = xor1_out & cin;
        const cout = and1_out | and2_out;

        // Update functional view
        document.getElementById('adder-sum-light').classList.toggle('on', sum === 1);
        document.getElementById('adder-cout-light').classList.toggle('on', cout === 1);
        
        // Update logic view wires
        document.getElementById('aw1').classList.toggle('active', a === 1);
        document.getElementById('aw2').classList.toggle('active', a === 1);
        document.getElementById('bw1').classList.toggle('active', b === 1);
        document.getElementById('bw2').classList.toggle('active', b === 1);
        document.getElementById('cinw1').classList.toggle('active', cin === 1);
        document.getElementById('xor1w').classList.toggle('active', xor1_out === 1);
        document.getElementById('xor1w-v').classList.toggle('active', xor1_out === 1);
        document.getElementById('and1w').classList.toggle('active', and1_out === 1);
        document.getElementById('sumw').classList.toggle('active', sum === 1);
        document.getElementById('and2w').classList.toggle('active', and2_out === 1);
        document.getElementById('coutw').classList.toggle('active', cout === 1);
    }
    
    // --- MUX Simulation ---
    function updateMux() {
        const s1 = parseInt(document.getElementById('mux-s1').dataset.value);
        const s0 = parseInt(document.getElementById('mux-s0').dataset.value);
        const d = [
            parseInt(document.getElementById('mux-d0').dataset.value),
            parseInt(document.getElementById('mux-d1').dataset.value),
            parseInt(document.getElementById('mux-d2').dataset.value),
            parseInt(document.getElementById('mux-d3').dataset.value)
        ];
        const selectIndex = (s1 << 1) | s0;
        const outputY = d[selectIndex];
        document.getElementById('mux-y-light').classList.toggle('on', outputY === 1);
    }

    // --- Decoder Simulation ---
    function updateDecoder() {
        const a1 = parseInt(document.getElementById('dec-a1').dataset.value);
        const a0 = parseInt(document.getElementById('dec-a0').dataset.value);
        const outputs = [
            document.getElementById('dec-y0-light'),
            document.getElementById('dec-y1-light'),
            document.getElementById('dec-y2-light'),
            document.getElementById('dec-y3-light')
        ];
        const selectIndex = (a1 << 1) | a0;
        outputs.forEach((light, index) => {
            light.classList.toggle('on', index === selectIndex);
        });
    }

    // --- Initial and Update Calls ---
    function runAllSimulators() {
        updateFullAdder();
        updateMux();
        updateDecoder();
    }
    
    document.addEventListener('updateSimulators', runAllSimulators);
    runAllSimulators(); // Initial run on page load
});
</script>

</body>
</html>
