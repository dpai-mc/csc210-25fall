<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSC210 - Module 2: Decoder Circuits</title>
    <style>
        :root {
            --primary-color: #2563eb;
            --secondary-color: #3b82f6;
            --accent-color: #f59e0b;
            --success-color: #059669;
            --error-color: #dc2626;
            --warning-color: #d97706;
            --info-color: #0891b2;
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --bg-tertiary: #f1f5f9;
            --text-primary: #1e293b;
            --text-secondary: #475569;
            --text-muted: #64748b;
            --text-inverse: #f8fafc;
            --border-color: #e2e8f0;
            --border-color-hover: #cbd5e1;
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --border-radius-md: 0.375rem;
            --border-radius-lg: 0.5rem;
            --transition-speed: 0.2s ease;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            margin: 0;
            padding: 2rem;
        }
        .module-container {
            max-width: 900px;
            margin: 0 auto;
        }
        h1, h2, h3 {
            color: var(--text-primary);
            margin-bottom: 1rem;
            font-weight: 700;
        }
        h1 { font-size: 2.25rem; border-bottom: 2px solid var(--border-color); padding-bottom: 1rem; }
        h2 { font-size: 1.75rem; margin-top: 2.5rem; }
        p { margin-bottom: 1rem; color: var(--text-secondary); }
        code {
            font-family: monospace;
            background-color: var(--bg-tertiary);
            padding: 2px 5px;
            border-radius: var(--border-radius-md);
        }
        .content-section {
            background: #fff;
            padding: 2rem;
            margin-bottom: 2rem;
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-md);
        }
        .simulation-container {
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: var(--bg-secondary);
            padding: 2rem;
            border-radius: var(--border-radius-md);
            border: 1px solid var(--border-color);
        }
        svg {
            max-width: 100%;
            height: auto;
        }
        .interactive-area rect, .interactive-area circle {
            cursor: pointer;
            transition: opacity 0.2s;
        }
        .interactive-area:hover { opacity: 0.8; }
        .wire { stroke: #9ca3af; stroke-width: 3; fill: none; transition: stroke 0.2s ease; }
        .wire.on { stroke: var(--accent-color); stroke-width: 4; }
        .gate { fill: var(--bg-tertiary); stroke: var(--primary-color); stroke-width: 2.5; }
        .label, .gate-label { font-size: 14px; font-weight: bold; fill: var(--text-primary); user-select: none; }
        .value { font-size: 16px; font-weight: bold; fill: var(--primary-color); }

        /* Interactive RAM Demo Styles */
        .interactive-ram-container { padding: 1.5rem; }
        .address-input-container { display: flex; flex-direction: column; align-items: center; margin-bottom: 1.5rem; }
        .address-input-container label { font-weight: 700; margin-bottom: 0.5rem; }
        #ram-address-input { width: 100%; max-width: 300px; padding: 0.5rem; font-size: 1.25rem; text-align: center; font-family: monospace; letter-spacing: 2px; border: 1px solid var(--border-color); border-radius: 4px; }
        .ram-grid-wrapper { display: grid; grid-template-columns: auto 1fr; gap: 10px; align-items: center; }
        .row-labels, .col-labels { font-family: monospace; font-size: 0.8rem; color: var(--text-secondary); display: grid; }
        .row-labels { grid-template-rows: repeat(16, 1fr); justify-items: end; }
        .col-labels { grid-template-columns: repeat(16, 1fr); text-align: center; }
        .ram-grid { display: grid; grid-template-columns: repeat(16, 1fr); border: 2px solid var(--border-color); }
        .ram-cell { aspect-ratio: 1; border: 1px solid var(--border-color); transition: background-color 0.2s ease, transform 0.2s ease; }
        .ram-cell.selected { background-color: var(--primary-color); border-color: var(--primary-color); box-shadow: 0 0 10px var(--primary-color); transform: scale(1.1); z-index: 10; }
        input:focus { outline: 2px solid var(--primary-color); outline-offset: 2px; }

        /* Quiz Styles */
        .quiz-form { list-style-type: none; padding: 0; }
        .quiz-form li { margin: 1rem 0; }
        .quiz-feedback { margin-top: 0.5rem; font-style: italic; font-weight: bold; }
        .quiz-feedback.correct { color: var(--success-color); }
        .quiz-feedback.incorrect { color: var(--error-color); }
        #quiz-results { padding: 1rem; border-radius: var(--border-radius-md); margin-top: 1rem; }
        #quiz-results.success { background-color: #d1fae5; color: #065f46; }
        #quiz-results.fail { background-color: #fee2e2; color: #991b1b; }
        
        /* Button Styles */
        .btn {
            display: inline-block;
            background-color: var(--primary-color);
            color: white;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: var(--border-radius-md);
            cursor: pointer;
            font-weight: 600;
            text-align: center;
            transition: background-color var(--transition-speed);
            text-decoration: none;
        }
        .btn:hover { 
            background-color: var(--secondary-color); 
            color: white; 
            text-decoration: none; 
        }
    </style>
</head>
<body>
    <div class="module-container">
        <header>
            <h1>Module 2: Decoder Circuits</h1>
        </header>

        <section id="section-1" class="content-section">
            <h2>Introduction to Decoders</h2>
            <p>A decoder is a combinational logic circuit that converts binary information from 'n' input lines to a maximum of '2^n' unique output lines. For a given binary input, only one output line is activated (goes HIGH), while all other outputs remain LOW. They are fundamental components in computers for tasks like memory address selection and instruction decoding.</p>
        </section>

        <section id="section-2" class="content-section">
            <h2>2-to-4 Decoder Simulation</h2>
            <p>The simplest decoder is a 2-to-4 decoder. It takes a 2-bit binary input (A and B) and activates one of four corresponding output lines. Click on the inputs A and B to see how the logic changes and a different output line is selected.</p>
            <div class="simulation-container">
                <svg id="decoder-2-4-svg" viewBox="0 0 500 400">
                    <!-- Inputs -->
                    <g class="interactive-area" id="input-a-group">
                        <rect x="20" y="90" width="60" height="30" fill="#e9ecef" stroke="#6c757d" rx="5"/>
                        <text class="label" x="35" y="110">A = <tspan id="val-a" class="value">0</tspan></text>
                    </g>
                    <g class="interactive-area" id="input-b-group">
                        <rect x="20" y="280" width="60" height="30" fill="#e9ecef" stroke="#6c757d" rx="5"/>
                        <text class="label" x="35" y="300">B = <tspan id="val-b" class="value">0</tspan></text>
                    </g>

                    <!-- Main wires and NOT gates -->
                    <path id="wire-a-main" class="wire" d="M 80 105 H 120"/>
                    <path class="gate" d="M 120 105 h 25 l -12.5 -15 v 30 z"/> <circle class="gate" cx="150" cy="105" r="5"/>
                    <path id="wire-a-not-main" class="wire" d="M 155 105 H 180"/>
                    <path id="wire-b-main" class="wire" d="M 80 295 H 120"/>
                    <path class="gate" d="M 120 295 h 25 l -12.5 -15 v 30 z"/> <circle class="gate" cx="150" cy="295" r="5"/>
                    <path id="wire-b-not-main" class="wire" d="M 155 295 H 180"/>
                    
                    <!-- Vertical Busses -->
                    <text class="label" x="195" y="40">A'</text><path id="bus-a-not" class="wire" d="M 200 50 V 350"/>
                    <text class="label" x="225" y="40">A</text><path id="bus-a-true" class="wire" d="M 230 50 V 350"/>
                    <text class="label" x="255" y="40">B'</text><path id="bus-b-not" class="wire" d="M 260 50 V 350"/>
                    <text class="label" x="285" y="40">B</text><path id="bus-b-true" class="wire" d="M 290 50 V 350"/>
                    
                    <!-- Taps from main wires to busses -->
                    <path class="wire on" d="M 180 105 h 20"/> <!-- A' tap -->
                    <path id="tap-a-true" class="wire" d="M 130 105 v 45 h 100"/> <!-- A tap -->
                    <path class="wire on" d="M 180 295 h 80"/> <!-- B' tap -->
                    <path id="tap-b-true" class="wire" d="M 130 295 v -45 h 160"/> <!-- B tap -->

                    <!-- AND Gates and Output Wires -->
                    <!-- Y0 = A'B' -->
                    <path id="tap-y0-anot" class="wire" d="M 200 75 H 320"/>
                    <path id="tap-y0-bnot" class="wire" d="M 260 75 H 320"/>
                    <path id="wire-y0" class="wire" d="M 420 75 H 480"/>
                    <path class="gate" d="M 320 50 h 50 a 25 25 0 0 1 0 50 h -50 z"/>
                    <text class="label" x="485" y="80">Y0</text>

                    <!-- Y1 = A'B -->
                    <path id="tap-y1-anot" class="wire" d="M 200 145 H 320"/>
                    <path id="tap-y1-b" class="wire" d="M 290 145 H 320"/>
                    <path id="wire-y1" class="wire" d="M 420 145 H 480"/>
                    <path class="gate" d="M 320 120 h 50 a 25 25 0 0 1 0 50 h -50 z"/>
                    <text class="label" x="485" y="150">Y1</text>
                    
                    <!-- Y2 = AB' -->
                    <path id="tap-y2-a" class="wire" d="M 230 215 H 320"/>
                    <path id="tap-y2-bnot" class="wire" d="M 260 215 H 320"/>
                    <path id="wire-y2" class="wire" d="M 420 215 H 480"/>
                    <path class="gate" d="M 320 190 h 50 a 25 25 0 0 1 0 50 h -50 z"/>
                    <text class="label" x="485" y="220">Y2</text>
                    
                    <!-- Y3 = AB -->
                    <path id="tap-y3-a" class="wire" d="M 230 285 H 320"/>
                    <path id="tap-y3-b" class="wire" d="M 290 285 H 320"/>
                    <path id="wire-y3" class="wire" d="M 420 285 H 480"/>
                    <path class="gate" d="M 320 260 h 50 a 25 25 0 0 1 0 50 h -50 z"/>
                    <text class="label" x="485" y="290">Y3</text>
                </svg>
            </div>
        </section>

        <section id="section-3" class="content-section">
            <h2>Use Case: 8-bit RAM Address Selection</h2>
            <p>Decoders are critical for selecting specific locations in memory. In a simplified 256-byte RAM, an 8-bit address can uniquely identify each byte. We can use two 4-to-16 decoders: one for the row and one for the column.</p>
            <p>In this simulation, the <strong>first 4 bits (RRRR) of the address select the row</strong>, and the <strong>last 4 bits (CCCC) select the column</strong>. Notice how the column addresses are mapped from right-to-left (column <code>0000</code> is on the far right), a common convention in memory diagrams.</p>
            
            <div class="interactive-ram-container">
                <div class="address-input-container">
                    <label for="ram-address-input">Enter 8-Bit Binary Address:</label>
                    <input type="text" id="ram-address-input" maxlength="8" placeholder="RRRRCCCC">
                </div>
                <div class="ram-grid-wrapper">
                    <div></div>
                    <div class="col-labels" id="col-labels-container"></div>
                    <div class="row-labels" id="row-labels-container"></div>
                    <div class="ram-grid" id="ram-grid"></div>
                </div>
            </div>
        </section>

        <section id="section-4" class="content-section">
            <h2>Assessment Quiz</h2>
            <p>Test your understanding of decoders.</p>
            <form id="quiz-form">
                <ul class="quiz-form">
                    <li>
                        <p><strong>1. What is the primary function of a decoder?</strong></p>
                        <input type="radio" id="q1a" name="q1" value="a"><label for="q1a"> To add binary numbers</label><br>
                        <input type="radio" id="q1b" name="q1" value="b"><label for="q1b"> To store data for later use</label><br>
                        <input type="radio" id="q1c" name="q1" value="c"><label for="q1c"> To activate a single output based on a binary input</label><br>
                        <div id="q1-feedback" class="quiz-feedback"></div>
                    </li>
                    <li>
                        <p><strong>2. A 3-to-8 decoder has how many input and output lines?</strong></p>
                        <input type="radio" id="q2a" name="q2" value="a"><label for="q2a"> 8 inputs, 3 outputs</label><br>
                        <input type="radio" id="q2b" name="q2" value="b"><label for="q2b"> 8 inputs, 8 outputs</label><br>
                        <input type="radio" id="q2c" name="q2" value="c"><label for="q2c"> 3 inputs, 8 outputs</label><br>
                        <div id="q2-feedback" class="quiz-feedback"></div>
                    </li>
                    <li>
                        <p><strong>3. If the input to a 2-to-4 decoder is binary 10, which output line will be active?</strong></p>
                        <input type="radio" id="q3a" name="q3" value="a"><label for="q3a"> Output 0</label><br>
                        <input type="radio" id="q3b" name="q3" value="b"><label for="q3b"> Output 1</label><br>
                        <input type="radio" id="q3c" name="q3" value="c"><label for="q3c"> Output 2</label><br>
                        <div id="q3-feedback" class="quiz-feedback"></div>
                    </li>
                </ul>
                <button type="submit" class="btn">Submit Answers</button>
            </form>
            <div id="quiz-results" style="display:none;"></div>
        </section>
        
        <section id="section-5" class="content-section">
            <h2>Apply Your Knowledge</h2>
            <p>Now that you've explored how decoders work, apply this knowledge by building one yourself in a circuit simulator.</p>
            <div style="text-align: center; margin-top: 1.5rem;">
                <a href="https://mendocino.instructure.com/courses/19705/pages/circuits-building-a-decoder-2" class="btn" target="_blank" rel="noopener noreferrer">
                    Build a 3-to-8 Decoder in Logisim 2.7.1
                </a>
            </div>
        </section>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- 2-to-4 Decoder ---
            const decoderState = { a: 0, b: 0 };
            const getEl = (id) => document.getElementById(id);

            function updateDecoderVisuals() {
                const { a, b } = decoderState;
                const notA = a === 0 ? 1 : 0;
                const notB = b === 0 ? 1 : 0;

                getEl('val-a').textContent = a;
                getEl('val-b').textContent = b;

                // Main input lines
                getEl('wire-a-main').classList.toggle('on', a === 1);
                getEl('wire-b-main').classList.toggle('on', b === 1);

                // Inverted lines
                getEl('wire-a-not-main').classList.toggle('on', notA === 1);
                getEl('wire-b-not-main').classList.toggle('on', notB === 1);
                
                // Busses
                getEl('bus-a-not').classList.toggle('on', notA === 1);
                getEl('bus-a-true').classList.toggle('on', a === 1);
                getEl('bus-b-not').classList.toggle('on', notB === 1);
                getEl('bus-b-true').classList.toggle('on', b === 1);
                
                // Taps to busses
                getEl('tap-a-true').classList.toggle('on', a === 1);
                getEl('tap-b-true').classList.toggle('on', b === 1);

                // Logic for each output
                const y0 = notA && notB;
                const y1 = notA && b;
                const y2 = a && notB;
                const y3 = a && b;
                
                // Taps to AND gates
                getEl('tap-y0-anot').classList.toggle('on', y0);
                getEl('tap-y0-bnot').classList.toggle('on', y0);
                getEl('tap-y1-anot').classList.toggle('on', y1);
                getEl('tap-y1-b').classList.toggle('on', y1);
                getEl('tap-y2-a').classList.toggle('on', y2);
                getEl('tap-y2-bnot').classList.toggle('on', y2);
                getEl('tap-y3-a').classList.toggle('on', y3);
                getEl('tap-y3-b').classList.toggle('on', y3);

                // Final output wires
                getEl('wire-y0').classList.toggle('on', y0);
                getEl('wire-y1').classList.toggle('on', y1);
                getEl('wire-y2').classList.toggle('on', y2);
                getEl('wire-y3').classList.toggle('on', y3);
            }

            getEl('input-a-group').addEventListener('click', () => {
                decoderState.a = 1 - decoderState.a;
                updateDecoderVisuals();
            });
            getEl('input-b-group').addEventListener('click', () => {
                decoderState.b = 1 - decoderState.b;
                updateDecoderVisuals();
            });
            updateDecoderVisuals();


            // --- Interactive RAM Grid ---
            const addressInput = document.getElementById('ram-address-input');
            const gridContainer = document.getElementById('ram-grid');
            const rowLabelsContainer = document.getElementById('row-labels-container');
            const colLabelsContainer = document.getElementById('col-labels-container');
            const cells = [];

            if (addressInput) {
                // Setup UI
                for (let i = 0; i < 256; i++) {
                    const cell = document.createElement('div');
                    cell.classList.add('ram-cell');
                    gridContainer.appendChild(cell);
                    cells.push(cell);
                }
                
                for (let i = 0; i < 16; i++) {
                    const rowLabel = document.createElement('div');
                    rowLabel.textContent = i.toString(2).padStart(4, '0');
                    rowLabelsContainer.appendChild(rowLabel);

                    const colLabel = document.createElement('div');
                    colLabel.textContent = (15 - i).toString(2).padStart(4, '0');
                    colLabelsContainer.appendChild(colLabel);
                }

                // Event Listener and Logic
                addressInput.addEventListener('input', () => {
                    const currentSelected = gridContainer.querySelector('.selected');
                    if (currentSelected) currentSelected.classList.remove('selected');

                    const address = addressInput.value.replace(/[^01]/g, '').substring(0, 8);
                    addressInput.value = address; 

                    if (address.length === 8) {
                        const row = parseInt(address.substring(0, 4), 2);
                        const col = parseInt(address.substring(4, 8), 2);
                        const visualCol = 15 - col;
                        const index = row * 16 + visualCol;
                        if (cells[index]) cells[index].classList.add('selected');
                    }
                });
            }

            // --- Quiz Logic ---
            const quizForm = document.getElementById('quiz-form');
            const quizResultsEl = document.getElementById('quiz-results');
            const answers = { q1: 'c', q2: 'c', q3: 'c' };

            quizForm.addEventListener('submit', (e) => {
                e.preventDefault();
                let score = 0;
                const totalQuestions = Object.keys(answers).length;
                
                for (const [q, correct] of Object.entries(answers)) {
                    const feedbackEl = document.getElementById(`${q}-feedback`);
                    const selected = quizForm.elements[q].value;
                    if (selected === correct) {
                        score++;
                        feedbackEl.textContent = '✔ Correct';
                        feedbackEl.className = 'quiz-feedback correct';
                    } else {
                        feedbackEl.textContent = '❌ Incorrect';
                        feedbackEl.className = 'quiz-feedback incorrect';
                    }
                }
                
                quizResultsEl.innerHTML = `<strong>Your Score: ${score} out of ${totalQuestions}</strong>`;
                quizResultsEl.className = score === totalQuestions ? 'success' : 'fail';
                quizResultsEl.innerHTML += score === totalQuestions ? '<p>Excellent! You have a solid understanding of decoders.</p>' : '<p>Review the module content and try again.</p>';
                quizResultsEl.style.display = 'block';
            });
        });
    </script>
</body>
</html>

