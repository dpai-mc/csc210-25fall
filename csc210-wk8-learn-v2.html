<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Week 8: MIPS Memory & Arrays - Interactive Learning Experience</title>
    
    <!-- CDN Links -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
    
    <!-- Meta Comments -->
    <!-- Chosen Palette: Scholarly Neutrals with education-focused accent colors -->
    <!-- Application Structure Plan: Tabbed interface with 6 learning modules, each containing interactive exercises, code examples, and practice activities -->
    <!-- Visualization & Content Choices: Progressive complexity with hands-on MIPS assembly examples, memory visualization tools, and immediate feedback for learning reinforcement -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #FDFBF8;
            color: #383838;
        }
        
        .code-block {
            font-family: 'Fira Code', monospace;
            background-color: #f8f9fa;
            border: 1px solid #EADDD7;
            border-radius: 0.5rem;
            padding: 1rem;
            white-space: pre-wrap;
            overflow-x: auto;
        }
        
        .interactive-input {
            font-family: 'Fira Code', monospace;
            border: 2px solid #D1C7BF;
            background-color: #FFFFFF;
            padding: 0.5rem;
            border-radius: 0.375rem;
            transition: all 0.2s ease;
        }
        
        .interactive-input:focus {
            outline: none;
            border-color: #4A90E2;
            box-shadow: 0 0 0 2px rgba(74, 144, 226, 0.3);
        }
        
        .tab-button {
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }
        
        .tab-button.active {
            background-color: #EADDD7;
            border-bottom-color: #4A90E2;
        }
        
        .tab-button:hover:not(.active) {
            background-color: #F0EBE8;
        }
        
        .feedback-correct {
            background-color: #d4edda;
            border-color: #c3e6cb;
            color: #155724;
        }
        
        .feedback-incorrect {
            background-color: #f8d7da;
            border-color: #f5c6cb;
            color: #721c24;
        }
        
        .memory-address {
            font-family: 'Fira Code', monospace;
            background-color: #e9ecef;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.875rem;
        }
        
        .progress-bar {
            background-color: #e9ecef;
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
        }
        
        .progress-fill {
            background-color: #4A90E2;
            height: 100%;
            transition: width 0.3s ease;
        }
        
        @media print {
            .no-print { display: none; }
            body { background-color: white; }
        }
    </style>
</head>
<body class="antialiased">
    <a href="#main-content" class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 bg-blue-600 text-white px-4 py-2 rounded">Skip to content</a>
    
    <header class="bg-white shadow-sm border-b border-gray-200 sticky top-0 z-10">
        <div class="max-w-6xl mx-auto px-4 py-4">
            <h1 class="text-2xl md:text-3xl font-bold text-gray-900">Week 8: MIPS Memory & Arrays</h1>
            <p class="text-lg text-gray-600 mt-2">Interactive Learning Experience</p>
            <div class="mt-4">
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-bar" style="width: 0%"></div>
                </div>
                <p class="text-sm text-gray-500 mt-1">Progress: <span id="progress-text">0% Complete</span></p>
            </div>
        </div>
    </header>

    <main id="main-content" class="max-w-6xl mx-auto p-4 md:p-8">
        <!-- Navigation Tabs -->
        <nav class="mb-8" role="tablist">
            <div class="flex flex-wrap gap-2 border-b border-gray-200">
                <button class="tab-button px-4 py-3 font-medium rounded-t-lg active" 
                        data-tab="overview" role="tab" aria-selected="true" aria-controls="overview-panel">
                    üìö Overview
                </button>
                <button class="tab-button px-4 py-3 font-medium rounded-t-lg" 
                        data-tab="memory-model" role="tab" aria-selected="false" aria-controls="memory-model-panel">
                    üß† Memory Model
                </button>
                <button class="tab-button px-4 py-3 font-medium rounded-t-lg" 
                        data-tab="load-store" role="tab" aria-selected="false" aria-controls="load-store-panel">
                    üîß Load/Store
                </button>
                <button class="tab-button px-4 py-3 font-medium rounded-t-lg" 
                        data-tab="addressing" role="tab" aria-selected="false" aria-controls="addressing-panel">
                    üîç Addressing
                </button>
                <button class="tab-button px-4 py-3 font-medium rounded-t-lg" 
                        data-tab="arrays" role="tab" aria-selected="false" aria-controls="arrays-panel">
                    üìã Arrays
                </button>
                <button class="tab-button px-4 py-3 font-medium rounded-t-lg" 
                        data-tab="advanced" role="tab" aria-selected="false" aria-controls="advanced-panel">
                    üöÄ Advanced
                </button>
                <button class="tab-button px-4 py-3 font-medium rounded-t-lg" 
                        data-tab="recursion" role="tab" aria-selected="false" aria-controls="recursion-panel">
                    üîÑ Recursion
                </button>
            </div>
        </nav>

        <!-- Tab Panels -->
        
        <!-- Overview Panel -->
        <section id="overview-panel" class="tab-panel" role="tabpanel" aria-labelledby="overview">
            <div class="bg-blue-50 border border-blue-200 rounded-lg p-6 mb-8">
                <h2 class="text-2xl font-bold mb-4">üéØ Learning Objectives</h2>
                <p class="text-lg mb-4">Transform from procedure-call programmers into memory manipulation experts!</p>
                <ul class="space-y-2 text-gray-700">
                    <li class="flex items-start"><span class="text-green-500 mr-2">‚úì</span>Use MIPS load/store instructions to access memory</li>
                    <li class="flex items-start"><span class="text-green-500 mr-2">‚úì</span>Understand and apply different addressing modes</li>
                    <li class="flex items-start"><span class="text-green-500 mr-2">‚úì</span>Manipulate arrays using MIPS assembly language</li>
                    <li class="flex items-start"><span class="text-green-500 mr-2">‚úì</span>Translate high-level array operations to MIPS code</li>
                    <li class="flex items-start"><span class="text-green-500 mr-2">‚úì</span>Debug memory-related issues in MARS</li>
                </ul>
            </div>
            
            <div class="grid md:grid-cols-2 gap-6">
                <div class="bg-white rounded-lg shadow-sm border p-6">
                    <h3 class="text-xl font-semibold mb-4">üìñ Learning Path</h3>
                    <ol class="space-y-3">
                        <li class="flex items-center">
                            <span class="bg-blue-100 text-blue-800 w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium mr-3">1</span>
                            <span>Memory Model Foundation</span>
                        </li>
                        <li class="flex items-center">
                            <span class="bg-blue-100 text-blue-800 w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium mr-3">2</span>
                            <span>Load/Store Mastery</span>
                        </li>
                        <li class="flex items-center">
                            <span class="bg-blue-100 text-blue-800 w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium mr-3">3</span>
                            <span>Addressing Modes</span>
                        </li>
                        <li class="flex items-center">
                            <span class="bg-blue-100 text-blue-800 w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium mr-3">4</span>
                            <span>Array Algorithms</span>
                        </li>
                        <li class="flex items-center">
                            <span class="bg-blue-100 text-blue-800 w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium mr-3">5</span>
                            <span>Multi-Dimensional Arrays</span>
                        </li>
                        <li class="flex items-center">
                            <span class="bg-blue-100 text-blue-800 w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium mr-3">6</span>
                            <span>Performance & Optimization</span>
                        </li>
                    </ol>
                </div>
                
                <div class="bg-white rounded-lg shadow-sm border p-6">
                    <h3 class="text-xl font-semibold mb-4">üõ†Ô∏è Prerequisites Check</h3>
                    <div class="space-y-3">
                        <label class="flex items-center">
                            <input type="checkbox" class="mr-3 rounded border-gray-300">
                            <span>MIPS procedure calls (Week 7)</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" class="mr-3 rounded border-gray-300">
                            <span>Basic arithmetic instructions</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" class="mr-3 rounded border-gray-300">
                            <span>Binary/hexadecimal numbers</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" class="mr-3 rounded border-gray-300">
                            <span>MARS environment navigation</span>
                        </label>
                    </div>
                </div>
            </div>
        </section>

        <!-- Memory Model Panel -->
        <section id="memory-model-panel" class="tab-panel hidden" role="tabpanel" aria-labelledby="memory-model">
            <h2 class="text-3xl font-bold mb-6">üß† Memory Model Foundation</h2>
            <p class="text-lg text-gray-700 mb-6">Understanding how MIPS organizes memory is the first step to mastering data manipulation. This section explores the key memory segments‚ÄîText, Data, and Stack‚Äîand the concept of endianness. Knowing where your data is stored and how it's arranged is crucial for preventing bugs and writing effective programs.</p>
            
            <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-6 mb-8">
                <h3 class="text-xl font-semibold mb-4">üîç Memory Detective Activity</h3>
                <p class="mb-4">Explore this MIPS program in MARS and answer the questions below:</p>
                <div class="code-block mb-4">.data
mystery_data: .word 0x12345678, 0x87654321, 0xDEADBEEF
.text
main:
    la $t0, mystery_data
    lw $t1, 0($t0)
    lw $t2, 4($t0)
    lw $t3, 8($t0)</div>
                
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium mb-2">What address did <code class="bg-gray-100 px-1 rounded">la $t0, mystery_data</code> load?</label>
                        <input type="text" class="interactive-input w-full max-w-md" placeholder="0x????????" data-answer="0x10010000">
                        <div class="feedback mt-2 p-2 rounded hidden"></div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium mb-2">Why does <code class="bg-gray-100 px-1 rounded">lw $t2, 4($t0)</code> access the second word instead of <code class="bg-gray-100 px-1 rounded">lw $t2, 1($t0)</code>?</label>
                        <select class="interactive-input w-full max-w-md" data-answer="word-size">
                            <option value="">Select an answer...</option>
                            <option value="word-size">Each word is 4 bytes, so we need offset of 4</option>
                            <option value="indexing">MIPS uses 1-based indexing</option>
                            <option value="alignment">Memory alignment requires even offsets</option>
                        </select>
                        <div class="feedback mt-2 p-2 rounded hidden"></div>
                    </div>
                </div>
            </div>
            
            <div class="grid md:grid-cols-2 gap-8">
                <div class="bg-white rounded-lg shadow-sm border p-6">
                    <h3 class="text-xl font-semibold mb-4">üìç Memory Segments</h3>
                    <div class="space-y-4">
                        <div class="border-l-4 border-blue-500 pl-4">
                            <h4 class="font-medium">Text Segment</h4>
                            <p class="text-sm text-gray-600">Start: <span class="memory-address">0x00400000</span></p>
                            <p class="text-sm">Program instructions</p>
                        </div>
                        <div class="border-l-4 border-green-500 pl-4">
                            <h4 class="font-medium">Data Segment</h4>
                            <p class="text-sm text-gray-600">Start: <span class="memory-address">0x10010000</span></p>
                            <p class="text-sm">Global variables (.data section)</p>
                        </div>
                        <div class="border-l-4 border-purple-500 pl-4">
                            <h4 class="font-medium">Stack Segment</h4>
                            <p class="text-sm text-gray-600">Start: <span class="memory-address">0x7ffffffc</span> (grows down)</p>
                            <p class="text-sm">Local variables, procedure calls</p>
                        </div>
                        <div class="border-l-4 border-orange-500 pl-4">
                            <h4 class="font-medium">Heap Segment</h4>
                            <p class="text-sm text-gray-600">Dynamic allocation</p>
                            <p class="text-sm">Malloc/free operations</p>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white rounded-lg shadow-sm border p-6">
                    <h3 class="text-xl font-semibold mb-4">üîÑ Endianness Explorer</h3>
                    <p class="text-sm text-gray-600 mb-4">MIPS uses big-endian byte ordering. Test your understanding:</p>
                    <div class="code-block mb-4">.data
test_word: .word 0x12345678
.text
main:
    lb $t0, 0(test_word)  # Byte 0
    lb $t1, 1(test_word)  # Byte 1
    lb $t2, 2(test_word)  # Byte 2
    lb $t3, 3(test_word)  # Byte 3</div>
                    
                    <div class="space-y-2">
                        <div class="flex items-center space-x-4">
                            <span class="w-16 text-sm">$t0 =</span>
                            <input type="text" class="interactive-input flex-1" placeholder="0x??" data-answer="0x12">
                        </div>
                        <div class="flex items-center space-x-4">
                            <span class="w-16 text-sm">$t1 =</span>
                            <input type="text" class="interactive-input flex-1" placeholder="0x??" data-answer="0x34">
                        </div>
                        <div class="flex items-center space-x-4">
                            <span class="w-16 text-sm">$t2 =</span>
                            <input type="text" class="interactive-input flex-1" placeholder="0x??" data-answer="0x56">
                        </div>
                        <div class="flex items-center space-x-4">
                            <span class="w-16 text-sm">$t3 =</span>
                            <input type="text" class="interactive-input flex-1" placeholder="0x??" data-answer="0x78">
                        </div>
                    </div>
                </div>
            </div>

            <div class="bg-white rounded-lg shadow-sm border p-6 mt-8">
                <h3 class="text-xl font-semibold mb-4">Endianness Explained: Big vs. Little</h3>
                <p class="text-gray-700 mb-4">
                    Endianness refers to the order in which bytes of a multi-byte data type (like a 32-bit word) are stored in computer memory. The two primary types are Big-Endian and Little-Endian. Understanding this is crucial for debugging, data exchange between different systems, and low-level programming.
                </p>
                <p class="text-gray-700 mb-4">
                    <strong>Big-Endian:</strong> The most significant byte (the "big end") is stored first, at the lowest memory address. This is similar to how we write numbers in English. MIPS is a big-endian architecture.
                </p>
                <p class="text-gray-700 mb-4">
                    <strong>Little-Endian:</strong> The least significant byte (the "little end") is stored first, at the lowest memory address. This is common in x86 architectures (like Intel and AMD processors).
                </p>
                <h4 class="font-semibold mb-2">Example: Storing <code>0x1A2B3C4D</code></h4>
                <div class="grid md:grid-cols-2 gap-6">
                    <div>
                        <h5 class="font-medium text-center mb-2">Big-Endian (MIPS)</h5>
                        <div class="code-block text-sm">Memory Address | Value
----------------|-------
0x1000         |  1A
0x1001         |  2B
0x1002         |  3C
0x1003         |  4D</div>
                    </div>
                    <div>
                        <h5 class="font-medium text-center mb-2">Little-Endian (x86)</h5>
                        <div class="code-block text-sm">Memory Address | Value
----------------|-------
0x1000         |  4D
0x1001         |  3C
0x1002         |  2B
0x1003         |  1A</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Load/Store Panel -->
        <section id="load-store-panel" class="tab-panel hidden" role="tabpanel" aria-labelledby="load-store">
            <h2 class="text-3xl font-bold mb-6">üîß Load/Store Mastery Workshop</h2>
            <p class="text-lg text-gray-700 mb-6">MIPS is a "load/store" architecture, which means data must be moved from memory into registers before it can be used in calculations. The `lw` (load word) and `sw` (store word) instructions are the essential bridge between your program's data in memory and the CPU's registers. Mastering this pattern is the most fundamental skill in MIPS programming.</p>
            
            <div class="bg-green-50 border border-green-200 rounded-lg p-6 mb-8">
                <h3 class="text-xl font-semibold mb-4">üéØ Level 1: Basic Load/Store Pattern</h3>
                <p class="mb-4">Complete the missing offsets to load each number:</p>
                <div class="code-block mb-4">.data
numbers: .word 10, 20, 30
.text
main:
    la $s0, numbers
    lw $t0, ___($s0)    # Load 10
    lw $t1, ___($s0)    # Load 20  
    lw $t2, ___($s0)    # Load 30</div>
                
                <div class="grid md:grid-cols-3 gap-4">
                    <div>
                        <label class="block text-sm font-medium mb-2">Load 10 (first element):</label>
                        <input type="text" class="interactive-input w-full" placeholder="offset" data-answer="0">
                        <div class="feedback mt-1 p-2 rounded hidden text-sm"></div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">Load 20 (second element):</label>
                        <input type="text" class="interactive-input w-full" placeholder="offset" data-answer="4">
                        <div class="feedback mt-1 p-2 rounded hidden text-sm"></div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">Load 30 (third element):</label>
                        <input type="text" class="interactive-input w-full" placeholder="offset" data-answer="8">
                        <div class="feedback mt-1 p-2 rounded hidden text-sm"></div>
                    </div>
                </div>
                <div class="mt-6 bg-gray-50 p-4 rounded-lg border">
                    <h4 class="font-semibold mb-2">üí° Pro Tip: Implicit Zero Offset & Assembler Shorthand</h4>
                    <p class="text-sm text-gray-700">You've noticed that multiple syntaxes work for a zero-offset load. This is the assembler helping you out!</p>
                    <ul class="text-sm text-gray-700 list-disc list-inside space-y-2 mt-2">
                        <li><code class="bg-gray-200 px-1 rounded">lw $t0, 0($s0)</code>: This is the <strong>canonical</strong> MIPS format. It's the clearest and what the hardware expects.</li>
                        <li><code class="bg-gray-200 px-1 rounded">lw $t0, ($s0)</code>: This is a <strong>standard shorthand</strong>. The assembler sees the parentheses and assumes an offset of 0.</li>
                        <li><code class="bg-gray-200 px-1 rounded">lw $t0, $s0</code>: This is a <strong>MARS-specific pseudo-instruction</strong>. The assembler interprets this as "dereference the pointer in `$s0`". It's convenient, but less portable. Be careful not to confuse it with <code class="bg-gray-200 px-1 rounded">move $t0, $s0</code>, which copies the address itself!</li>
                    </ul>
                     <p class="text-sm text-gray-700 mt-2"><strong>Recommendation:</strong> Stick to the <code class="bg-gray-200 px-1 rounded">0($s0)</code> format for maximum clarity and portability.</p>
                </div>
            </div>
            
            <div class="bg-white rounded-lg shadow-sm border p-6 mb-8">
                <h3 class="text-xl font-semibold mb-4">üìä Level 2: Understanding Data Types</h3>
                <div class="overflow-x-auto">
                    <table class="w-full border-collapse border border-gray-300">
                        <thead>
                            <tr class="bg-gray-50">
                                <th class="border border-gray-300 px-4 py-2 text-left">Instruction</th>
                                <th class="border border-gray-300 px-4 py-2 text-left">Data Loaded</th>
                                <th class="border border-gray-300 px-4 py-2 text-left">Sign Extension</th>
                                <th class="border border-gray-300 px-4 py-2 text-left">Use Case</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="border border-gray-300 px-4 py-2"><code>lw</code></td>
                                <td class="border border-gray-300 px-4 py-2">4 bytes</td>
                                <td class="border border-gray-300 px-4 py-2">N/A</td>
                                <td class="border border-gray-300 px-4 py-2">Integers, addresses</td>
                            </tr>
                            <tr>
                                <td class="border border-gray-300 px-4 py-2"><code>lh</code></td>
                                <td class="border border-gray-300 px-4 py-2">2 bytes</td>
                                <td class="border border-gray-300 px-4 py-2">Yes</td>
                                <td class="border border-gray-300 px-4 py-2">Signed short</td>
                            </tr>
                            <tr>
                                <td class="border border-gray-300 px-4 py-2"><code>lhu</code></td>
                                <td class="border border-gray-300 px-4 py-2">2 bytes</td>
                                <td class="border border-gray-300 px-4 py-2">No</td>
                                <td class="border border-gray-300 px-4 py-2">Unsigned short</td>
                            </tr>
                            <tr>
                                <td class="border border-gray-300 px-4 py-2"><code>lb</code></td>
                                <td class="border border-gray-300 px-4 py-2">1 byte</td>
                                <td class="border border-gray-300 px-4 py-2">Yes</td>
                                <td class="border border-gray-300 px-4 py-2">Signed char</td>
                            </tr>
                            <tr>
                                <td class="border border-gray-300 px-4 py-2"><code>lbu</code></td>
                                <td class="border border-gray-300 px-4 py-2">1 byte</td>
                                <td class="border border-gray-300 px-4 py-2">No</td>
                                <td class="border border-gray-300 px-4 py-2">Unsigned char, ASCII</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                 <div class="mt-6 bg-gray-50 p-4 rounded-lg border">
                    <h4 class="font-semibold mb-2">Signed vs. Unsigned: What's the Difference?</h4>
                    <p class="text-sm text-gray-700 mb-2">
                        <strong>char (1 byte) / short (2 bytes):</strong> These data types are smaller than a full 32-bit word.
                    </p>
                    <ul class="text-sm text-gray-700 list-disc list-inside space-y-1">
                        <li>A <strong>signed</strong> type uses its most significant bit (MSB) to represent the sign (0 for positive, 1 for negative). A signed char can represent values from -128 to 127.</li>
                        <li>An <strong>unsigned</strong> type uses all its bits to represent the magnitude of the number. An unsigned char can represent values from 0 to 255.</li>
                    </ul>
                    <p class="text-sm text-gray-700 mt-3">
                        <strong>Why is this important?</strong> When you load a smaller type into a 32-bit register (e.g., using `lb` or `lh`), the processor needs to know how to fill the remaining bits. The `lbu` and `lhu` instructions fill the upper bits with zeros (zero-extension), which is correct for unsigned numbers. The `lb` and `lh` instructions perform "sign extension," copying the sign bit to the upper bits to preserve the value of a negative number. Choosing the wrong instruction can lead to major bugs!
                    </p>
                </div>
            </div>
            
            <div class="bg-blue-50 border border-blue-200 rounded-lg p-6">
                <h3 class="text-xl font-semibold mb-4">üèÜ Level 3: Store Operations Challenge</h3>
                <p class="mb-4">Write MIPS code to store the pattern: 1, 4, 9, 16, 25 (squares) into memory:</p>
                <div class="code-block mb-4">.data
destination: .space 20    # 5 words of space
.text
main:
    la $s0, destination
    # Your code here - store each square</div>
                
                <textarea class="interactive-input w-full h-32 resize-none" 
                          placeholder="Write your MIPS assembly code here...&#10;Example:&#10;li $t0, 1&#10;sw $t0, 0($s0)&#10;li $t1, 4&#10;sw $t1, 4($s0)&#10;# Continue pattern..."></textarea>
                
                <button class="mt-4 bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition-colors" 
                        onclick="checkStoreChallenge()">
                    Check Solution
                </button>
                <div id="store-feedback" class="feedback mt-2 p-2 rounded hidden"></div>
            </div>
        </section>

        <!-- Addressing Panel -->
        <section id="addressing-panel" class="tab-panel hidden" role="tabpanel" aria-labelledby="addressing">
            <h2 class="text-3xl font-bold mb-6">üîç Addressing Modes Deep Dive</h2>
            <p class="text-lg text-gray-700 mb-6">How does the processor find the exact byte it needs in a vast sea of memory? Through addressing modes. The most common mode in MIPS, base plus offset addressing (`offset($register)`), is the key to working with arrays and other data structures. This section will solidify your ability to calculate the effective memory addresses used by load and store instructions.</p>
            
            <div class="bg-purple-50 border border-purple-200 rounded-lg p-6 mb-8">
                <h3 class="text-xl font-semibold mb-4">üßÆ Interactive Address Calculator</h3>
                <p class="mb-4">Given: Base register <code class="bg-gray-100 px-1 rounded">$s0 = 0x10010010</code></p>
                
                <div class="overflow-x-auto">
                    <table class="w-full border-collapse border border-gray-300">
                        <thead>
                            <tr class="bg-gray-50">
                                <th class="border border-gray-300 px-4 py-2 text-left">Instruction</th>
                                <th class="border border-gray-300 px-4 py-2 text-left">Offset</th>
                                <th class="border border-gray-300 px-4 py-2 text-left">Effective Address</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="border border-gray-300 px-4 py-2"><code>lw $t0, 0($s0)</code></td>
                                <td class="border border-gray-300 px-4 py-2">0</td>
                                <td class="border border-gray-300 px-4 py-2">
                                    <input type="text" class="interactive-input w-full" placeholder="0x????????" data-answer="0x10010010">
                                </td>
                            </tr>
                            <tr>
                                <td class="border border-gray-300 px-4 py-2"><code>lw $t0, -4($s0)</code></td>
                                <td class="border border-gray-300 px-4 py-2">-4</td>
                                <td class="border border-gray-300 px-4 py-2">
                                    <input type="text" class="interactive-input w-full" placeholder="0x????????" data-answer="0x1001000c">
                                </td>
                            </tr>
                            <tr>
                                <td class="border border-gray-300 px-4 py-2"><code>lw $t0, 12($s0)</code></td>
                                <td class="border border-gray-300 px-4 py-2">12</td>
                                <td class="border border-gray-300 px-4 py-2">
                                    <input type="text" class="interactive-input w-full" placeholder="0x????????" data-answer="0x1001001c">
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <button class="mt-4 bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700 transition-colors" 
                        onclick="checkAddressing()">
                    Check Addresses
                </button>
                <div id="addressing-feedback" class="feedback mt-2 p-2 rounded hidden"></div>
            </div>
            
            <div class="bg-red-50 border border-red-200 rounded-lg p-6">
                <h3 class="text-xl font-semibold mb-4">üêõ Debug the Addressing Errors</h3>
                <p class="mb-4">This code has bugs. What did the programmer intend, and how do we fix it?</p>
                <div class="code-block mb-4">.data
array: .word 1, 2, 3, 4, 5
.text
main:
    la $t0, array
    lw $t1, 1($t0)     # BUG: What's wrong?
    lw $t2, 2($t0)     # BUG: What's wrong?</div>
                
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium mb-2">What did the programmer intend?</label>
                        <select class="interactive-input w-full max-w-md" data-answer="access-elements">
                            <option value="">Select an answer...</option>
                            <option value="access-elements">Access array[1] and array[2]</option>
                            <option value="load-bytes">Load individual bytes</option>
                            <option value="increment">Increment memory addresses</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium mb-2">What's the correct way to access array[1]?</label>
                        <input type="text" class="interactive-input w-full max-w-md" placeholder="lw $t1, ___($t0)" data-answer="4">
                        <div class="feedback mt-2 p-2 rounded hidden"></div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium mb-2">What's the general rule for word array access?</label>
                        <textarea class="interactive-input w-full h-20 resize-none" 
                                  placeholder="Explain the indexing rule..."></textarea>
                    </div>
                </div>
            </div>
        </section>

        <!-- Arrays Panel -->
        <section id="arrays-panel" class="tab-panel hidden" role="tabpanel" aria-labelledby="arrays">
            <h2 class="text-3xl font-bold mb-6">üìã Array Algorithms Workshop</h2>
            <p class="text-lg text-gray-700 mb-6">Arrays are one of the most common data structures. In this section, we'll combine our knowledge of memory, load/store instructions, and addressing to implement common array algorithms. Translating high-level loops and index-based access (e.g., `array[i]`) into MIPS assembly is a critical skill for any assembly language programmer.</p>
            
            <div class="bg-green-50 border border-green-200 rounded-lg p-6 mb-8">
                <h3 class="text-xl font-semibold mb-4">üéØ Stage 1: Array Traversal Patterns</h3>
                <p class="mb-4">Master the fundamental pattern for sequential array access:</p>
                <div class="code-block mb-4">.data
arr: .word 10, 20, 30, 40, 50
size: .word 5
.text
traverse_sequential:
    la $s0, arr         # Base address
    lw $s1, size        # Array size
    li $t0, 0           # Index
    
loop:
    beq $t0, $s1, done  # Check bounds
    sll $t1, $t0, 2     # Index * 4
    add $t2, $s0, $t1   # Calculate address
    lw $t3, 0($t2)      # Load element
    
    # Process element in $t3 here
    
    addi $t0, $t0, 1    # Increment index
    j loop
done:</div>
                
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium mb-2">Why do we use <code class="bg-gray-100 px-1 rounded">sll $t1, $t0, 2</code>?</label>
                        <select class="interactive-input w-full max-w-md" data-answer="multiply-by-4">
                            <option value="">Select an answer...</option>
                            <option value="multiply-by-4">Multiply index by 4 (word size)</option>
                            <option value="divide-by-4">Divide index by 4</option>
                            <option value="shift-bits">Shift bits for efficiency</option>
                        </select>
                        <div class="feedback mt-2 p-2 rounded hidden"></div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium mb-2">What does <code class="bg-gray-100 px-1 rounded">add $t2, $s0, $t1</code> calculate?</label>
                        <input type="text" class="interactive-input w-full max-w-md" placeholder="Effective address of..." data-answer="array[i]">
                        <div class="feedback mt-2 p-2 rounded hidden"></div>
                    </div>
                </div>
            </div>
            
            <div class="grid md:grid-cols-2 gap-8">
                <div class="bg-white rounded-lg shadow-sm border p-6">
                    <h3 class="text-xl font-semibold mb-4">üßÆ Array Sum Calculator</h3>
                    <p class="text-sm text-gray-600 mb-4">Complete this function to calculate array sum:</p>
                    <div class="code-block mb-4"># Input: $a0 = array base address, $a1 = size
# Output: $v0 = sum
array_sum:
    li $v0, 0           # Initialize sum
    li $t0, 0           # Initialize index
    
sum_loop:
    beq $t0, $a1, sum_done
    sll $t1, $t0, 2     # Calculate offset
    add $t2, $a0, $t1   # Calculate address
    lw $t3, 0($t2)      # Load element
    
    # What instruction goes here?
    _____ $v0, $v0, $t3  # Add to sum
    
    addi $t0, $t0, 1    # Increment index
    j sum_loop
    
sum_done:
    jr $ra</div>
                    
                    <label class="block text-sm font-medium mb-2">What instruction adds the element to the sum?</label>
                    <input type="text" class="interactive-input w-full" placeholder="Instruction" data-answer="add">
                    <div class="feedback mt-2 p-2 rounded hidden"></div>
                </div>
                
                <div class="bg-white rounded-lg shadow-sm border p-6">
                    <h3 class="text-xl font-semibold mb-4">üîç Min/Max Finder</h3>
                    <p class="text-sm text-gray-600 mb-4">Challenge: Find both min and max in one pass!</p>
                    <div class="code-block mb-4"># Input: $a0 = array base, $a1 = size
# Output: $v0 = min, $v1 = max
find_min_max:
    lw $v0, 0($a0)      # Initialize min
    lw $v1, 0($a0)      # Initialize max
    li $t0, 1           # Start from index 1
    
minmax_loop:
    beq $t0, $a1, minmax_done
    sll $t1, $t0, 2
    add $t2, $a0, $t1
    lw $t3, 0($t2)
    
    # Compare with current min
    blt $t3, $v0, update_min
    # Compare with current max  
    bgt $t3, $v1, update_max
    j continue_loop
    
update_min:
    move $v0, $t3
    j continue_loop
    
update_max:
    move $v1, $t3
    
continue_loop:
    addi $t0, $t0, 1
    j minmax_loop
    
minmax_done:
    jr $ra</div>
                    
                    <button class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 transition-colors">
                        Test Algorithm
                    </button>
                </div>
            </div>
            
            <div class="bg-blue-50 border border-blue-200 rounded-lg p-6 mt-8">
                <h3 class="text-xl font-semibold mb-4">üîÑ Real-World Application: Grade Processing</h3>
                <p class="mb-4">Implement a grade processing system similar to real gradebook software:</p>
                <div class="code-block mb-4">.data
grades: .word 85, 92, 78, 96, 88, 71, 89, 93
num_grades: .word 8
grade_sum: .word 0
average: .word 0
above_avg_count: .word 0

.text
# Task 1: Calculate total and average
# Task 2: Count grades above average
# Task 3: Find highest and lowest grades</div>
                
                <div class="space-y-4">
                    <label class="block text-sm font-medium mb-2">Step 1: Calculate the sum of all grades</label>
                    <textarea class="interactive-input w-full h-24 resize-none" 
                              placeholder="Write MIPS code to sum the grades array..."></textarea>
                    
                    <label class="block text-sm font-medium mb-2">Step 2: How do you calculate the average?</label>
                    <input type="text" class="interactive-input w-full max-w-md" placeholder="sum / count" data-answer="div">
                    
                    <label class="block text-sm font-medium mb-2">Step 3: Count grades above average</label>
                    <textarea class="interactive-input w-full h-24 resize-none" 
                              placeholder="Write pseudocode for counting above-average grades..."></textarea>
                </div>
            </div>
        </section>

        <!-- Advanced Panel -->
        <section id="advanced-panel" class="tab-panel hidden" role="tabpanel" aria-labelledby="advanced">
            <h2 class="text-3xl font-bold mb-6">üöÄ Advanced Topics & Optimization</h2>
            <p class="text-lg text-gray-700 mb-6">Now that you've mastered the fundamentals, it's time to explore more complex applications and performance considerations. This section covers multi-dimensional arrays, C-style string manipulation (which are just arrays of characters), and the performance implications of memory access patterns. Understanding these topics is key to writing sophisticated and efficient MIPS programs.</p>
            
            <div class="grid md:grid-cols-2 gap-8 mb-8">
                <div class="bg-white rounded-lg shadow-sm border p-6">
                    <h3 class="text-xl font-semibold mb-4">üèóÔ∏è 2D Array Address Calculation</h3>
                    <p class="text-sm text-gray-600 mb-4">Row-major order formula:</p>
                    <div class="bg-gray-100 p-4 rounded-lg mb-4">
                        <code>Address = base + (row √ó cols + col) √ó element_size</code>
                    </div>
                    
                    <p class="mb-4">Given a 3√ó4 matrix starting at 0x10010000:</p>
                    <div class="space-y-3">
                        <div class="flex items-center space-x-4">
                            <span class="w-20 text-sm">matrix[1][2] =</span>
                            <input type="text" class="interactive-input flex-1" placeholder="0x????????" data-answer="0x10010018">
                        </div>
                        <div class="flex items-center space-x-4">
                            <span class="w-20 text-sm">matrix[0][3] =</span>
                            <input type="text" class="interactive-input flex-1" placeholder="0x????????" data-answer="0x1001000c">
                        </div>
                        <div class="flex items-center space-x-4">
                            <span class="w-20 text-sm">matrix[2][1] =</span>
                            <input type="text" class="interactive-input flex-1" placeholder="0x????????" data-answer="0x10010024">
                        </div>
                    </div>
                    
                    <button class="mt-4 bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700 transition-colors" 
                            onclick="check2DAddresses()">
                        Check Calculations
                    </button>
                    <div id="matrix-feedback" class="feedback mt-2 p-2 rounded hidden"></div>
                </div>
                
                <div class="bg-white rounded-lg shadow-sm border p-6">
                    <h3 class="text-xl font-semibold mb-4">üéØ String Processing Challenge</h3>
                    <p class="text-sm text-gray-600 mb-4">Implement basic string operations:</p>
                    <div class="code-block mb-4">.data
message: .asciiz "Hello, MIPS World!"
target_char: .byte 'l'
count: .word 0

.text
# Count occurrences of target_char in message</div>
                    
                    <div class="space-y-4">
                        <label class="block text-sm font-medium mb-2">How do you load a single character?</label>
                        <select class="interactive-input w-full" data-answer="lbu">
                            <option value="">Select instruction...</option>
                            <option value="lw">lw (load word)</option>
                            <option value="lbu">lbu (load byte unsigned)</option>
                            <option value="lb">lb (load byte)</option>
                        </select>
                        
                        <label class="block text-sm font-medium mb-2">How do you detect the end of a string?</label>
                        <input type="text" class="interactive-input w-full" placeholder="Compare with..." data-answer="null">
                        
                        <label class="block text-sm font-medium mb-2">Write the character counting loop:</label>
                        <textarea class="interactive-input w-full h-32 resize-none" 
                                  placeholder="count_loop:&#10;    # Load character&#10;    # Check for null terminator&#10;    # Compare with target&#10;    # Increment count if match&#10;    # Move to next character&#10;    # Repeat"></textarea>
                    </div>
                </div>
            </div>
            
            <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-6 mb-8">
                <h3 class="text-xl font-semibold mb-4">‚ö° Performance Optimization Lab</h3>
                <p class="mb-4">Compare cache-friendly vs. cache-unfriendly access patterns:</p>
                
                <div class="grid md:grid-cols-2 gap-6">
                    <div>
                        <h4 class="font-semibold mb-2 text-green-600">‚úÖ Cache-Friendly (Row-Major)</h4>
                        <div class="code-block text-sm">for (i = 0; i < ROWS; i++) {
    for (j = 0; j < COLS; j++) {
        matrix[i][j] = value;
    }
}</div>
                        <p class="text-sm text-gray-600 mt-2">Accesses consecutive memory locations</p>
                    </div>
                    
                    <div>
                        <h4 class="font-semibold mb-2 text-red-600">‚ùå Cache-Unfriendly (Column-Major)</h4>
                        <div class="code-block text-sm">for (j = 0; j < COLS; j++) {
    for (i = 0; i < ROWS; i++) {
        matrix[i][j] = value;
    }
}</div>
                        <p class="text-sm text-gray-600 mt-2">Jumps around in memory</p>
                    </div>
                </div>
                
                <div class="mt-6">
                    <label class="block text-sm font-medium mb-2">Why is spatial locality important for performance?</label>
                    <textarea class="interactive-input w-full h-20 resize-none" 
                              placeholder="Explain how cache lines and spatial locality affect performance..."></textarea>
                </div>
            </div>
            
            <div class="bg-red-50 border border-red-200 rounded-lg p-6">
                <h3 class="text-xl font-semibold mb-4">üêõ Common Pitfalls & Debugging</h3>
                <div class="space-y-6">
                    <div>
                        <h4 class="font-semibold mb-2">Error 1: Off-by-One in Array Bounds</h4>
                        <div class="code-block mb-2"># BUGGY CODE
li $t0, 0           # index
li $t1, 5           # array size
loop:
    bgt $t0, $t1, done   # BUG: Should be bge
    # Process array[t0]
    addi $t0, $t0, 1
    j loop</div>
                        <label class="block text-sm font-medium mb-1">What's the fix?</label>
                        <input type="text" class="interactive-input w-full max-w-md" placeholder="Change bgt to..." data-answer="bge">
                    </div>
                    
                    <div>
                        <h4 class="font-semibold mb-2">Error 2: Forgetting Word Size Scaling</h4>
                        <div class="code-block mb-2"># BUGGY CODE
li $t0, 2           # Want array[2]
lw $t1, $t0(array)  # BUG: Missing scaling</div>
                        <label class="block text-sm font-medium mb-1">What should it be?</label>
                        <input type="text" class="interactive-input w-full max-w-md" placeholder="lw $t1, ___" data-answer="8">
                    </div>
                    
                    <div>
                        <h4 class="font-semibold mb-2">Error 3: Alignment Violations</h4>
                        <p class="text-sm mb-2">What happens if you try <code>lw $t0, 1($s0)</code> where $s0 is word-aligned?</p>
                        <select class="interactive-input w-full max-w-md" data-answer="exception">
                            <option value="">Select outcome...</option>
                            <option value="works-fine">Works perfectly</option>
                            <option value="exception">Alignment exception</option>
                            <option value="wrong-data">Loads wrong data</option>
                        </select>
                    </div>
                </div>
            </div>
        </section>

        <!-- Recursion Panel -->
        <section id="recursion-panel" class="tab-panel hidden" role="tabpanel" aria-labelledby="recursion">
            <h2 class="text-3xl font-bold mb-6">üîÑ Recursion in MIPS</h2>
            <p class="text-lg text-gray-700 mb-6">
                Recursion is a powerful programming technique where a function calls itself to solve a problem. In MIPS, this requires careful management of the stack. Because a recursive call is just like any other function call, we must follow the standard procedure call convention: save the return address (`$ra`) and any caller-saved registers (`$s0-$s7`) that we modify onto the stack before making the recursive call (`jal`). After the call returns, we must restore those values from the stack.
            </p>

            <div class="bg-blue-50 border border-blue-200 rounded-lg p-6 mb-8">
                <h3 class="text-xl font-semibold mb-4">üß© Interactive Factorial Example</h3>
                <p class="mb-4">Complete the MIPS code for a recursive factorial function. Remember: factorial(n) = n * factorial(n-1), and the base case is factorial(0) = 1.</p>
                <div class="code-block mb-4"># Input: $a0 = n
# Output: $v0 = n!
factorial:
    # --- Stack Frame Setup ---
    addi $sp, $sp, -8       # Make space for 2 items
    ___________________     # Save return address
    sw $a0, 4($sp)          # Save current n
    
    # --- Base Case ---
    slti $t0, $a0, 1        # if (n < 1), then t0 = 1
    beq $t0, $zero, recursive_step
    
    # if we are in the base case (n=0 or n=1):
    li $v0, 1               # Return 1
    addi $sp, $sp, 8        # Deallocate stack frame
    jr $ra                  # Return to caller
    
recursive_step:
    # --- Recursive Call ---
    addi $a0, $a0, -1       # n = n - 1
    ___________________     # Call factorial(n-1)
    
    # --- Post-Recursion ---
    lw $a0, 4($sp)          # Restore original n
    ___________________     # Restore return address
    addi $sp, $sp, 8        # Deallocate stack frame
    
    mul $v0, $a0, $v0       # result = n * factorial(n-1)
    
    jr $ra                  # Return final result</div>
                
                <div class="space-y-4 mt-4">
                    <div>
                        <label class="block text-sm font-medium mb-2">1. What instruction saves the return address?</label>
                        <input type="text" id="fact_q1" class="interactive-input w-full max-w-md" placeholder="instruction..." data-answer="sw $ra, 0($sp)">
                    </div>
                     <div>
                        <label class="block text-sm font-medium mb-2">2. What instruction makes the recursive call?</label>
                        <input type="text" id="fact_q2" class="interactive-input w-full max-w-md" placeholder="instruction..." data-answer="jal factorial">
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">3. What instruction restores the return address?</label>
                        <input type="text" id="fact_q3" class="interactive-input w-full max-w-md" placeholder="instruction..." data-answer="lw $ra, 0($sp)">
                    </div>
                </div>
                <button class="mt-4 bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition-colors" 
                        onclick="checkFactorialCode()">
                    Check Factorial Code
                </button>
                <div id="factorial-feedback" class="feedback mt-2 p-2 rounded hidden"></div>
            </div>

            <div class="bg-green-50 border border-green-200 rounded-lg p-6">
                <h3 class="text-xl font-semibold mb-4">üèÜ Challenge: Recursive Fibonacci</h3>
                <p class="mb-4">The Fibonacci sequence is defined as F(n) = F(n-1) + F(n-2), with base cases F(0)=0 and F(1)=1. This requires two recursive calls! Think about how you would implement this in MIPS and answer the questions below.</p>
                <div class="code-block mb-4"># High-level logic
fib(n):
  if (n <= 1) return n
  
  val1 = fib(n-1)
  val2 = fib(n-2)
  
  return val1 + val2</div>

                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium mb-2">After the first recursive call `jal fib` returns, the value of `$a0` has changed. What register must you save to the stack (besides `$ra`) so you can calculate `n-2` for the second call?</label>
                        <select id="fib_q1" class="interactive-input w-full max-w-md" data-answer="$a0">
                            <option value="">Select a register...</option>
                            <option value="$v0">$v0 (Return value)</option>
                            <option value="$a0">$a0 (Argument n)</option>
                            <option value="$t0">$t0 (Temporary register)</option>
                            <option value="$sp">$sp (Stack pointer)</option>
                        </select>
                    </div>
                     <div>
                        <label class="block text-sm font-medium mb-2">After the first call `fib(n-1)` returns, its result is in `$v0`. You need to save this result before making the second call to `fib(n-2)`. What is the best place to save it?</label>
                        <select id="fib_q2" class="interactive-input w-full max-w-md" data-answer="stack">
                            <option value="">Select a location...</option>
                             <option value="stack">On the stack</option>
                            <option value="register-s0">In a saved register ($s0)</option>
                            <option value="register-t0">In a temporary register ($t0)</option>
                        </select>
                    </div>
                </div>
                 <button class="mt-4 bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 transition-colors" 
                        onclick="checkFibonacciLogic()">
                    Check Fibonacci Logic
                </button>
                <div id="fibonacci-feedback" class="feedback mt-2 p-2 rounded hidden"></div>
            </div>
        </section>

        <!-- Assessment Summary -->
        <div class="bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-200 rounded-lg p-6 mt-8">
            <h2 class="text-2xl font-bold mb-4">üìà Week 8 Assessment Preparation</h2>
            <div class="grid md:grid-cols-2 gap-6">
                <div>
                    <h3 class="text-lg font-semibold mb-3">üéØ Key Skills to Learn</h3>
                    <ul class="space-y-2 text-sm">
                        <li class="flex items-start">
                            <span class="text-green-500 mr-2 mt-1">‚úì</span>
                            <span>Calculate memory addresses given base + offset</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-green-500 mr-2 mt-1">‚úì</span>
                            <span>Translate C/Java array code to MIPS assembly</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-green-500 mr-2 mt-1">‚úì</span>
                            <span>Debug common memory access errors</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-green-500 mr-2 mt-1">‚úì</span>
                            <span>Implement basic array algorithms (sum, search, sort)</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-green-500 mr-2 mt-1">‚úì</span>
                            <span>Understand memory segment organization</span>
                        </li>
                    </ul>
                </div>
                
                <div>
                    <h3 class="text-lg font-semibold mb-3">üîó Connections to Future Topics</h3>
                    <ul class="space-y-2 text-sm">
                        <li class="flex items-start">
                            <span class="text-blue-500 mr-2 mt-1">‚Üí</span>
                            <span>Memory as fundamental CPU component (Week 9)</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-blue-500 mr-2 mt-1">‚Üí</span>
                            <span>Load/store unit in CPU datapath design</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-blue-500 mr-2 mt-1">‚Üí</span>
                            <span>Memory hierarchy concepts (cache, main memory)</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-blue-500 mr-2 mt-1">‚Üí</span>
                            <span>Hardware-software interface understanding</span>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Tab functionality
            const tabButtons = document.querySelectorAll('.tab-button');
            const tabPanels = document.querySelectorAll('.tab-panel');
            let completedSections = new Set();
            
            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const targetTab = button.getAttribute('data-tab');
                    
                    // Update button states
                    tabButtons.forEach(btn => {
                        btn.classList.remove('active');
                        btn.setAttribute('aria-selected', 'false');
                    });
                    button.classList.add('active');
                    button.setAttribute('aria-selected', 'true');
                    
                    // Update panel visibility
                    tabPanels.forEach(panel => {
                        panel.classList.add('hidden');
                    });
                    document.getElementById(`${targetTab}-panel`).classList.remove('hidden');
                });
            });
            
            // Interactive input validation
            const inputs = document.querySelectorAll('.interactive-input');
            
            inputs.forEach(input => {
                input.addEventListener('input', () => {
                    const userAnswer = input.value.toLowerCase().trim();
                    const correctAnswer = input.getAttribute('data-answer');
                    const feedbackElement = input.parentElement.querySelector('.feedback');
                    
                    if (correctAnswer && feedbackElement) {
                        if (userAnswer === correctAnswer.toLowerCase().trim()) {
                            feedbackElement.className = 'feedback mt-2 p-2 rounded feedback-correct';
                            feedbackElement.textContent = '‚úÖ Correct! Great job!';
                            feedbackElement.classList.remove('hidden');
                            markSectionProgress();
                        } else if (userAnswer.length > 0) {
                            feedbackElement.className = 'feedback mt-2 p-2 rounded feedback-incorrect';
                            feedbackElement.textContent = '‚ùå Not quite right. Try again!';
                            feedbackElement.classList.remove('hidden');
                        } else {
                            feedbackElement.classList.add('hidden');
                        }
                    }
                });
                
                // Handle select elements
                if (input.tagName === 'SELECT') {
                    input.addEventListener('change', () => {
                        const userAnswer = input.value;
                        const correctAnswer = input.getAttribute('data-answer');
                        const feedbackElement = input.parentElement.querySelector('.feedback');
                        
                        if (correctAnswer && feedbackElement) {
                            if (userAnswer === correctAnswer) {
                                feedbackElement.className = 'feedback mt-2 p-2 rounded feedback-correct';
                                feedbackElement.textContent = '‚úÖ Excellent understanding!';
                                feedbackElement.classList.remove('hidden');
                                markSectionProgress();
                            } else if (userAnswer !== '') {
                                feedbackElement.className = 'feedback mt-2 p-2 rounded feedback-incorrect';
                                feedbackElement.textContent = '‚ùå Incorrect. Think about the concept again.';
                                feedbackElement.classList.remove('hidden');
                            }
                        }
                    });
                }
            });
            
            function markSectionProgress() {
                const activePanel = document.querySelector('.tab-panel:not(.hidden)');
                if (activePanel) {
                    completedSections.add(activePanel.id);
                    updateProgressBar();
                }
            }
            
            function updateProgressBar() {
                const totalSections = tabPanels.length;
                const progress = totalSections > 0 ? (completedSections.size / totalSections) * 100 : 0;
                document.getElementById('progress-bar').style.width = `${progress}%`;
                document.getElementById('progress-text').textContent = `${Math.round(progress)}% Complete`;
            }
            
            // Store challenge checker
            window.checkStoreChallenge = () => {
                const textarea = document.querySelector('#store-feedback').previousElementSibling.previousElementSibling;
                const code = textarea.value.toLowerCase();
                const feedback = document.getElementById('store-feedback');
                
                const hasCorrectPattern = 
                    code.includes('li $t0, 1') && code.includes('sw $t0, 0($s0)') &&
                    code.includes('li $t1, 4') && code.includes('sw $t1, 4($s0)') &&
                    code.includes('25') && code.includes('16($s0)');
                
                if (hasCorrectPattern) {
                    feedback.className = 'feedback mt-2 p-2 rounded feedback-correct';
                    feedback.textContent = '‚úÖ Great! You understand the pattern of storing consecutive words.';
                } else {
                    feedback.className = 'feedback mt-2 p-2 rounded feedback-incorrect';
                    feedback.textContent = '‚ùå Make sure to load each square value and store at proper word offsets (0, 4, 8, 12, 16).';
                }
                feedback.classList.remove('hidden');
            };
            
            // Address calculation checker
            window.checkAddressing = () => {
                const inputs = document.querySelectorAll('#addressing-panel .interactive-input');
                const feedback = document.getElementById('addressing-feedback');
                let allCorrect = true;
                
                inputs.forEach(input => {
                    const userAnswer = input.value.toLowerCase().trim();
                    const correctAnswer = input.getAttribute('data-answer');
                    if (userAnswer !== correctAnswer) {
                        allCorrect = false;
                    }
                });
                
                if (allCorrect) {
                    feedback.className = 'feedback mt-2 p-2 rounded feedback-correct';
                    feedback.textContent = '‚úÖ Perfect! You master address calculation with base + offset.';
                } else {
                    feedback.className = 'feedback mt-2 p-2 rounded feedback-incorrect';
                    feedback.textContent = '‚ùå Check your hex arithmetic. Remember: base + offset = effective address.';
                }
                feedback.classList.remove('hidden');
            };
            
            // 2D array address checker
            window.check2DAddresses = () => {
                const inputs = document.querySelectorAll('#matrix-feedback').parentElement.querySelectorAll('.interactive-input');
                const feedback = document.getElementById('matrix-feedback');
                let allCorrect = true;
                
                inputs.forEach(input => {
                    const userAnswer = input.value.toLowerCase().trim();
                    const correctAnswer = input.getAttribute('data-answer');
                    if (userAnswer !== correctAnswer) {
                        allCorrect = false;
                    }
                });
                
                if (allCorrect) {
                    feedback.className = 'feedback mt-2 p-2 rounded feedback-correct';
                    feedback.textContent = '‚úÖ Outstanding! You master 2D array address calculations.';
                } else {
                    feedback.className = 'feedback mt-2 p-2 rounded feedback-incorrect';
                    feedback.textContent = '‚ùå Remember: base + (row √ó cols + col) √ó element_size. For 3√ó4 matrix with 4-byte words.';
                }
                feedback.classList.remove('hidden');
                markSectionProgress();
            };
            
             // Factorial code checker
            window.checkFactorialCode = () => {
                const q1 = document.getElementById('fact_q1').value.toLowerCase().trim().replace(/\s+/g, ' ');
                const q2 = document.getElementById('fact_q2').value.toLowerCase().trim().replace(/\s+/g, ' ');
                const q3 = document.getElementById('fact_q3').value.toLowerCase().trim().replace(/\s+/g, ' ');
                const feedback = document.getElementById('factorial-feedback');

                const ans1 = "sw $ra, 0($sp)";
                const ans2 = "jal factorial";
                const ans3 = "lw $ra, 0($sp)";
                
                if (q1 === ans1 && q2 === ans2 && q3 === ans3) {
                    feedback.className = 'feedback mt-2 p-2 rounded feedback-correct';
                    feedback.textContent = '‚úÖ Perfect! You correctly identified all the key steps for MIPS recursion.';
                    markSectionProgress();
                } else {
                    let errorMsg = "‚ùå Not quite. Check your answers:\n";
                    if (q1 !== ans1) errorMsg += "\n- Review how to save the return address to the stack.";
                    if (q2 !== ans2) errorMsg += "\n- Remember which instruction performs a function call.";
                    if (q3 !== ans3) errorMsg += "\n- Don't forget to restore the return address before jumping back.";
                    feedback.className = 'feedback mt-2 p-2 rounded feedback-incorrect';
                    feedback.textContent = errorMsg;
                }
                feedback.classList.remove('hidden');
            };

            // Fibonacci logic checker
            window.checkFibonacciLogic = () => {
                const q1 = document.getElementById('fib_q1').value;
                const q2 = document.getElementById('fib_q2').value;
                const feedback = document.getElementById('fibonacci-feedback');

                const ans1 = "$a0";
                const ans2 = "stack";

                if (q1 === ans1 && q2 === ans2) {
                    feedback.className = 'feedback mt-2 p-2 rounded feedback-correct';
                    feedback.textContent = '‚úÖ Exactly right! You must save the original `n` ($a0) to calculate `n-2` later, and you must save the first result on the stack because the second recursive call will overwrite `$v0`.';
                    markSectionProgress();
                } else {
                    let errorMsg = "‚ùå Let's rethink the logic:\n";
                     if (q1 !== ans1) errorMsg += "\n- The argument register `$a0` is clobbered by the first recursive call, so the original value of `n` must be saved to be used for the second call.";
                     if (q2 !== ans2) errorMsg += "\n- Saving the first result in a temporary register (`$t0`) is risky because the nested function call might use it. Saving to the stack is the safest and standard approach.";
                    feedback.className = 'feedback mt-2 p-2 rounded feedback-incorrect';
                    feedback.textContent = errorMsg;
                }
                feedback.classList.remove('hidden');
            };
            
            // Keyboard navigation
            document.addEventListener('keydown', (e) => {
                if (e.ctrlKey && e.key >= '1' && e.key <= '7') {
                    e.preventDefault();
                    const tabIndex = parseInt(e.key) - 1;
                    if (tabButtons[tabIndex]) {
                        tabButtons[tabIndex].click();
                    }
                }
            });
        });
    </script>
</body>
</html>

